import{r as n,c as t,h as r,g as e}from"./p-96f7121f.js";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var i=function(){return(i=Object.assign||function(n){for(var t,r=1,e=arguments.length;r<e;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)};function u(n,t,r){if(r||2===arguments.length)for(var e,i=0,u=t.length;i<u;i++)!e&&i in t||(e||(e=Array.prototype.slice.call(t,0,i)),e[i]=t[i]);return n.concat(e||Array.prototype.slice.call(t))}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,a=Object.keys,f=Array.isArray;function c(n,t){return"object"!=typeof t||a(t).forEach((function(r){n[r]=t[r]})),n}"undefined"==typeof Promise||o.Promise||(o.Promise=Promise);var s=Object.getPrototypeOf,l={}.hasOwnProperty;function h(n,t){return l.call(n,t)}function v(n,t){"function"==typeof t&&(t=t(s(n))),("undefined"==typeof Reflect?a:Reflect.ownKeys)(t).forEach((function(r){y(n,r,t[r])}))}var d=Object.defineProperty;function y(n,t,r,e){d(n,t,c(r&&h(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},e))}function p(n){return{from:function(t){return n.prototype=Object.create(t.prototype),y(n.prototype,"constructor",n),{extend:v.bind(null,n.prototype)}}}}var w=Object.getOwnPropertyDescriptor;function m(n,t){var r;return w(n,t)||(r=s(n))&&m(r,t)}var g=[].slice;function b(n,t,r){return g.call(n,t,r)}function x(n,t){return t(n)}function k(n){if(!n)throw new Error("Assertion Failed")}function E(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function A(n,t){return n.reduce((function(n,r,e){var i=t(r,e);return i&&(n[i[0]]=i[1]),n}),{})}function j(n,t){if(h(n,t))return n[t];if(!t)return n;if("string"!=typeof t){for(var r=[],e=0,i=t.length;e<i;++e){var u=j(n,t[e]);r.push(u)}return r}var o=t.indexOf(".");if(-1!==o){var a=n[t.substr(0,o)];return void 0===a?void 0:j(a,t.substr(o+1))}}function S(n,t,r){if(n&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(n)))if("string"!=typeof t&&"length"in t){k("string"!=typeof r&&"length"in r);for(var e=0,i=t.length;e<i;++e)S(n,t[e],r[e])}else{var u=t.indexOf(".");if(-1!==u){var o=t.substr(0,u),a=t.substr(u+1);if(""===a)void 0===r?f(n)&&!isNaN(parseInt(o))?n.splice(o,1):delete n[o]:n[o]=r;else{var c=n[o];c||(c=n[o]={}),S(c,a,r)}}else void 0===r?f(n)&&!isNaN(parseInt(t))?n.splice(t,1):delete n[t]:n[t]=r}}function P(n){var t={};for(var r in n)h(n,r)&&(t[r]=n[r]);return t}var O=[].concat;function D(n){return O.apply([],n)}var C="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(D([8,16,32,64].map((function(n){return["Int","Uint","Float"].map((function(t){return t+n+"Array"}))})))).filter((function(n){return o[n]})),I=C.map((function(n){return o[n]}));A(C,(function(n){return[n,!0]}));var T=null;function R(n){T="undefined"!=typeof WeakMap&&new WeakMap;var t=B(n);return T=null,t}function B(n){if(!n||"object"!=typeof n)return n;var t=T&&T.get(n);if(t)return t;if(f(n)){t=[],T&&T.set(n,t);for(var r=0,e=n.length;r<e;++r)t.push(B(n[r]))}else if(I.indexOf(n.constructor)>=0)t=n;else{var i=s(n);for(var u in t=i===Object.prototype?{}:Object.create(i),T&&T.set(n,t),n)h(n,u)&&(t[u]=B(n[u]))}return t}var M={}.toString;function K(n){return M.call(n).slice(8,-1)}var N="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",q="symbol"==typeof N?function(n){var t;return null!=n&&(t=n[N])&&t.apply(n)}:function(){return null},F={};function U(n){var t,r,e,i;if(1===arguments.length){if(f(n))return n.slice();if(this===F&&"string"==typeof n)return[n];if(i=q(n)){for(r=[];!(e=i.next()).done;)r.push(e.value);return r}if(null==n)return[n];if("number"==typeof(t=n.length)){for(r=new Array(t);t--;)r[t]=n[t];return r}return[n]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var _="undefined"!=typeof Symbol?function(n){return"AsyncFunction"===n[Symbol.toStringTag]}:function(){return!1},L="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function H(n,t){L=n,V=t}var V=function(){return!0},W=!new Error("").stack;function z(){if(W)try{throw new Error}catch(n){return n}return new Error}function G(n,t){var r=n.stack;return r?(t=t||0,0===r.indexOf(n.name)&&(t+=(n.name+n.message).split("\n").length),r.split("\n").slice(t).filter(V).map((function(n){return"\n"+n})).join("")):""}var $=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],J=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat($),Y={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Q(n,t){this._e=z(),this.name=n,this.message=t}function X(n,t){return n+". Errors: "+Object.keys(t).map((function(n){return t[n].toString()})).filter((function(n,t,r){return r.indexOf(n)===t})).join("\n")}function Z(n,t,r,e){this._e=z(),this.failures=t,this.failedKeys=e,this.successCount=r,this.message=X(n,t)}function nn(n,t){this._e=z(),this.name="BulkError",this.failures=Object.keys(t).map((function(n){return t[n]})),this.failuresByPos=t,this.message=X(n,t)}p(Q).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+G(this._e,2))}},toString:function(){return this.name+": "+this.message}}),p(Z).from(Q),p(nn).from(Q);var tn=J.reduce((function(n,t){return n[t]=t+"Error",n}),{}),rn=Q,en=J.reduce((function(n,t){var r=t+"Error";function e(n,e){this._e=z(),this.name=r,n?"string"==typeof n?(this.message=n+(e?"\n "+e:""),this.inner=e||null):"object"==typeof n&&(this.message=n.name+" "+n.message,this.inner=n):(this.message=Y[t]||r,this.inner=null)}return p(e).from(rn),n[t]=e,n}),{});en.Syntax=SyntaxError,en.Type=TypeError,en.Range=RangeError;var un=$.reduce((function(n,t){return n[t+"Error"]=en[t],n}),{}),on=J.reduce((function(n,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(n[t+"Error"]=en[t]),n}),{});function an(){}function fn(n){return n}function cn(n,t){return null==n||n===fn?t:function(r){return t(n(r))}}function sn(n,t){return function(){n.apply(this,arguments),t.apply(this,arguments)}}function ln(n,t){return n===an?t:function(){var r=n.apply(this,arguments);void 0!==r&&(arguments[0]=r);var e=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return e&&(this.onsuccess=this.onsuccess?sn(e,this.onsuccess):e),i&&(this.onerror=this.onerror?sn(i,this.onerror):i),void 0!==u?u:r}}function hn(n,t){return n===an?t:function(){n.apply(this,arguments);var r=this.onsuccess,e=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?sn(r,this.onsuccess):r),e&&(this.onerror=this.onerror?sn(e,this.onerror):e)}}function vn(n,t){return n===an?t:function(r){var e=n.apply(this,arguments);c(r,e);var i=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?sn(i,this.onsuccess):i),u&&(this.onerror=this.onerror?sn(u,this.onerror):u),void 0===e?void 0===o?void 0:o:c(e,o)}}function dn(n,t){return n===an?t:function(){return!1!==t.apply(this,arguments)&&n.apply(this,arguments)}}function yn(n,t){return n===an?t:function(){var r=n.apply(this,arguments);if(r&&"function"==typeof r.then){for(var e=this,i=arguments.length,u=new Array(i);i--;)u[i]=arguments[i];return r.then((function(){return t.apply(e,u)}))}return t.apply(this,arguments)}}on.ModifyError=Z,on.DexieError=Q,on.BulkError=nn;var pn={},wn="undefined"==typeof Promise?[]:function(){var n=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[n,s(n),n];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,s(t),n]}(),mn=wn[0],gn=wn[1],bn=wn[2],xn=gn&&gn.then,kn=mn&&mn.constructor,En=!!bn,An=!1,jn=bn?function(){bn.then($n)}:o.setImmediate?setImmediate.bind(null,$n):o.MutationObserver?function(){var n=document.createElement("div");new MutationObserver((function(){$n(),n=null})).observe(n,{attributes:!0}),n.setAttribute("i","1")}:function(){setTimeout($n,0)},Sn=function(n,t){Mn.push([n,t]),On&&(jn(),On=!1)},Pn=!0,On=!0,Dn=[],Cn=[],In=null,Tn=fn,Rn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:mt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(n){try{mt(n[0],n[1])}catch(n){}}))}},Bn=Rn,Mn=[],Kn=0,Nn=[];function qn(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=an,this._lib=!1;var t=this._PSD=Bn;if(L&&(this._stackHolder=z(),this._prev=null,this._numPrev=0),"function"!=typeof n){if(n!==pn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ln(this,this._value))}this._state=null,this._value=null,++t.ref,_n(this,n)}var Fn={get:function(){var n=Bn,t=it;function r(r,e){var i=this,u=!n.global&&(n!==Bn||t!==it),o=u&&!ft(),a=new qn((function(t,a){Vn(i,new Un(pt(r,n,u,o),pt(e,n,u,o),t,a,n))}));return L&&Gn(a,this),a}return r.prototype=pn,r},set:function(n){y(this,"then",n&&n.prototype===pn?Fn:{get:function(){return n},set:Fn.set})}};function Un(n,t,r,e,i){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=r,this.reject=e,this.psd=i}function _n(n,t){try{t((function(t){if(null===n._state){if(t===n)throw new TypeError("A promise cannot be resolved with itself.");var r=n._lib&&Jn();t&&"function"==typeof t.then?_n(n,(function(n,r){t instanceof qn?t._then(n,r):t.then(n,r)})):(n._state=!0,n._value=t,Hn(n)),r&&Yn()}}),Ln.bind(null,n))}catch(t){Ln(n,t)}}function Ln(n,t){if(Cn.push(t),null===n._state){var r=n._lib&&Jn();t=Tn(t),n._state=!1,n._value=t,L&&null!==t&&"object"==typeof t&&!t._promise&&function(){try{(function(){var r=m(t,"stack");t._promise=n,y(t,"stack",{get:function(){return An?r&&(r.get?r.get.apply(t):r.value):n.stack}})}).apply(null,void 0)}catch(n){}}(),function(n){Dn.some((function(t){return t._value===n._value}))||Dn.push(n)}(n),Hn(n),r&&Yn()}}function Hn(n){var t=n._listeners;n._listeners=[];for(var r=0,e=t.length;r<e;++r)Vn(n,t[r]);var i=n._PSD;--i.ref||i.finalize(),0===Kn&&(++Kn,Sn((function(){0==--Kn&&Qn()}),[]))}function Vn(n,t){if(null!==n._state){var r=n._state?t.onFulfilled:t.onRejected;if(null===r)return(n._state?t.resolve:t.reject)(n._value);++t.psd.ref,++Kn,Sn(Wn,[r,n,t])}else n._listeners.push(t)}function Wn(n,t,r){try{In=t;var e,i=t._value;t._state?e=n(i):(Cn.length&&(Cn=[]),e=n(i),-1===Cn.indexOf(i)&&function(n){for(var t=Dn.length;t;)if(Dn[--t]._value===n._value)return void Dn.splice(t,1)}(t)),r.resolve(e)}catch(n){r.reject(n)}finally{In=null,0==--Kn&&Qn(),--r.psd.ref||r.psd.finalize()}}function zn(n,t,r){if(t.length===r)return t;var e="";if(!1===n._state){var i,u,o=n._value;null!=o?(i=o.name||"Error",u=o.message||o,e=G(o,0)):(i=o,u=""),t.push(i+(u?": "+u:"")+e)}return L&&((e=G(n._stackHolder,2))&&-1===t.indexOf(e)&&t.push(e),n._prev&&zn(n._prev,t,r)),t}function Gn(n,t){var r=t?t._numPrev+1:0;r<100&&(n._prev=t,n._numPrev=r)}function $n(){Jn()&&Yn()}function Jn(){var n=Pn;return Pn=!1,On=!1,n}function Yn(){var n,t,r;do{for(;Mn.length>0;)for(n=Mn,Mn=[],r=n.length,t=0;t<r;++t){var e=n[t];e[0].apply(null,e[1])}}while(Mn.length>0);Pn=!0,On=!0}function Qn(){var n=Dn;Dn=[],n.forEach((function(n){n._PSD.onunhandled.call(null,n._value,n)}));for(var t=Nn.slice(0),r=t.length;r;)t[--r]()}function Xn(n){return new qn(pn,!1,n)}function Zn(n,t){var r=Bn;return function(){var e=Jn(),i=Bn;try{return ht(r,!0),n.apply(this,arguments)}catch(n){t&&t(n)}finally{ht(i,!1),e&&Yn()}}}v(qn.prototype,{then:Fn,_then:function(n,t){Vn(this,new Un(null,null,n,t,Bn))},catch:function(n){if(1===arguments.length)return this.then(null,n);var t=arguments[0],r=arguments[1];return this.then(null,"function"==typeof t?function(n){return n instanceof t?r(n):Xn(n)}:function(n){return n&&n.name===t?r(n):Xn(n)})},finally:function(n){return this.then((function(t){return n(),t}),(function(t){return n(),Xn(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{An=!0;var n=zn(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=n),n}finally{An=!1}}},timeout:function(n,t){var r=this;return n<1/0?new qn((function(e,i){var u=setTimeout((function(){return i(new en.Timeout(t))}),n);r.then(e,i).finally(clearTimeout.bind(null,u))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&y(qn.prototype,Symbol.toStringTag,"Dexie.Promise"),Rn.env=vt(),v(qn,{all:function(){var n=U.apply(null,arguments).map(ct);return new qn((function(t,r){0===n.length&&t([]);var e=n.length;n.forEach((function(i,u){return qn.resolve(i).then((function(r){n[u]=r,--e||t(n)}),r)}))}))},resolve:function(n){if(n instanceof qn)return n;if(n&&"function"==typeof n.then)return new qn((function(t,r){n.then(t,r)}));var t=new qn(pn,!0,n);return Gn(t,In),t},reject:Xn,race:function(){var n=U.apply(null,arguments).map(ct);return new qn((function(t,r){n.map((function(n){return qn.resolve(n).then(t,r)}))}))},PSD:{get:function(){return Bn},set:function(n){return Bn=n}},totalEchoes:{get:function(){return it}},newPSD:ot,usePSD:dt,scheduler:{get:function(){return Sn},set:function(n){Sn=n}},rejectionMapper:{get:function(){return Tn},set:function(n){Tn=n}},follow:function(n,t){return new qn((function(r,e){return ot((function(t,r){var e=Bn;e.unhandleds=[],e.onunhandled=r,e.finalize=sn((function(){var n=this;Nn.push((function e(){0===n.unhandleds.length?t():r(n.unhandleds[0]),Nn.splice(Nn.indexOf(e),1)})),++Kn,Sn((function(){0==--Kn&&Qn()}),[])}),e.finalize),n()}),t,r,e)}))}}),kn&&(kn.allSettled&&y(qn,"allSettled",(function(){var n=U.apply(null,arguments).map(ct);return new qn((function(t){0===n.length&&t([]);var r=n.length,e=new Array(r);n.forEach((function(n,i){return qn.resolve(n).then((function(n){return e[i]={status:"fulfilled",value:n}}),(function(n){return e[i]={status:"rejected",reason:n}})).then((function(){return--r||t(e)}))}))}))})),kn.any&&"undefined"!=typeof AggregateError&&y(qn,"any",(function(){var n=U.apply(null,arguments).map(ct);return new qn((function(t,r){0===n.length&&r(new AggregateError([]));var e=n.length,i=new Array(e);n.forEach((function(n,u){return qn.resolve(n).then((function(n){return t(n)}),(function(n){i[u]=n,--e||r(new AggregateError(i))}))}))}))})));var nt={awaits:0,echoes:0,id:0},tt=0,rt=[],et=0,it=0,ut=0;function ot(n,t,r,e){var i=Bn,u=Object.create(i);u.parent=i,u.ref=0,u.global=!1,u.id=++ut;var o=Rn.env;u.env=En?{Promise:qn,PromiseProp:{value:qn,configurable:!0,writable:!0},all:qn.all,race:qn.race,allSettled:qn.allSettled,any:qn.any,resolve:qn.resolve,reject:qn.reject,nthen:wt(o.nthen,u),gthen:wt(o.gthen,u)}:{},t&&c(u,t),++i.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=dt(u,n,r,e);return 0===u.ref&&u.finalize(),a}function at(){return nt.id||(nt.id=++tt),++nt.awaits,nt.echoes+=100,nt.id}function ft(){return!!nt.awaits&&(0==--nt.awaits&&(nt.id=0),nt.echoes=100*nt.awaits,!0)}function ct(n){return nt.echoes&&n&&n.constructor===kn?(at(),n.then((function(n){return ft(),n}),(function(n){return ft(),gt(n)}))):n}function st(n){++it,nt.echoes&&0!=--nt.echoes||(nt.echoes=nt.id=0),rt.push(Bn),ht(n,!0)}function lt(){var n=rt[rt.length-1];rt.pop(),ht(n,!1)}function ht(n,t){var r=Bn;if((t?!nt.echoes||et++&&n===Bn:!et||--et&&n===Bn)||yt(t?st.bind(null,n):lt),n!==Bn&&(Bn=n,r===Rn&&(Rn.env=vt()),En)){var e=Rn.env.Promise,i=n.env;gn.then=i.nthen,e.prototype.then=i.gthen,(r.global||n.global)&&(Object.defineProperty(o,"Promise",i.PromiseProp),e.all=i.all,e.race=i.race,e.resolve=i.resolve,e.reject=i.reject,i.allSettled&&(e.allSettled=i.allSettled),i.any&&(e.any=i.any))}}function vt(){var n=o.Promise;return En?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject,nthen:gn.then,gthen:n.prototype.then}:{}}function dt(n,t,r,e,i){var u=Bn;try{return ht(n,!0),t(r,e,i)}finally{ht(u,!1)}}function yt(n){xn.call(mn,n)}function pt(n,t,r,e){return"function"!=typeof n?n:function(){var i=Bn;r&&at(),ht(t,!0);try{return n.apply(this,arguments)}finally{ht(i,!1),e&&yt(ft)}}}function wt(n,t){return function(r,e){return n.call(this,pt(r,t),pt(e,t))}}function mt(n,t){var r;try{r=t.onuncatched(n)}catch(n){}if(!1!==r)try{var e,i={promise:t,reason:n};if(o.document&&document.createEvent?((e=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),c(e,i)):o.CustomEvent&&c(e=new CustomEvent("unhandledrejection",{detail:i}),i),e&&o.dispatchEvent&&(dispatchEvent(e),!o.PromiseRejectionEvent&&o.onunhandledrejection))try{o.onunhandledrejection(e)}catch(n){}L&&e&&!e.defaultPrevented&&console.warn("Unhandled rejection: "+(n.stack||n))}catch(n){}}-1===(""+xn).indexOf("[native code]")&&(at=ft=an);var gt=qn.reject;function bt(n,t,r,e){if(n.idbdb&&(n._state.openComplete||Bn.letThrough||n._vip)){var i=n._createTransaction(t,r,n._dbSchema);try{i.create()}catch(n){return gt(n)}return i._promise(t,(function(n,t){return ot((function(){return Bn.trans=i,e(n,t,i)}))})).then((function(n){return i._completion.then((function(){return n}))}))}if(n._state.openComplete)return gt(new en.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen)return gt(new en.DatabaseClosed);n.open().catch(an)}return n._state.dbReadyPromise.then((function(){return bt(n,t,r,e)}))}var xt=String.fromCharCode(65535),kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Et=[],At="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),jt=At,St=At,Pt=function(n){return!/(dexie\.js|dexie\.min\.js)/.test(n)};function Ot(n,t){return n?t?function(){return n.apply(this,arguments)&&t.apply(this,arguments)}:n:t}var Dt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ct(n){return"string"!=typeof n||/\./.test(n)?function(n){return n}:function(t){return void 0===t[n]&&n in t&&delete(t=R(t))[n],t}}var It=function(){function n(){}return n.prototype._trans=function(n,t,r){var e=this._tx||Bn.trans,i=this.name;function u(n,r,e){if(!e.schema[i])throw new en.NotFound("Table "+i+" not part of transaction");return t(e.idbtrans,e)}var o=Jn();try{return e&&e.db===this.db?e===Bn.trans?e._promise(n,u,r):ot((function(){return e._promise(n,u,r)}),{trans:e,transless:Bn.transless||Bn}):bt(this.db,n,[this.name],u)}finally{o&&Yn()}},n.prototype.get=function(n,t){var r=this;return n&&n.constructor===Object?this.where(n).first(t):this._trans("readonly",(function(t){return r.core.get({trans:t,key:n}).then((function(n){return r.hook.reading.fire(n)}))})).then(t)},n.prototype.where=function(n){if("string"==typeof n)return new this.db.WhereClause(this,n);if(f(n))return new this.db.WhereClause(this,"["+n.join("+")+"]");var t=a(n);if(1===t.length)return this.where(t[0]).equals(n[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter((function(n){return n.compound&&t.every((function(t){return n.keyPath.indexOf(t)>=0}))&&n.keyPath.every((function(n){return t.indexOf(n)>=0}))}))[0];if(r&&this.db._maxKey!==xt)return this.where(r.name).equals(r.keyPath.map((function(t){return n[t]})));!r&&L&&console.warn("The query "+JSON.stringify(n)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var e=this.schema.idxByName,i=this.db._deps.indexedDB;function u(n,t){try{return 0===i.cmp(n,t)}catch(n){return!1}}var o=t.reduce((function(t,r){var i=t[0],o=t[1],a=e[r],c=n[r];return[i||a,i||!a?Ot(o,a&&a.multi?function(n){var t=j(n,r);return f(t)&&t.some((function(n){return u(c,n)}))}:function(n){return u(c,j(n,r))}):o]}),[null,null]),c=o[0],s=o[1];return c?this.where(c.name).equals(n[c.keyPath]).filter(s):r?this.filter(s):this.where(t).equals("")},n.prototype.filter=function(n){return this.toCollection().and(n)},n.prototype.count=function(n){return this.toCollection().count(n)},n.prototype.offset=function(n){return this.toCollection().offset(n)},n.prototype.limit=function(n){return this.toCollection().limit(n)},n.prototype.each=function(n){return this.toCollection().each(n)},n.prototype.toArray=function(n){return this.toCollection().toArray(n)},n.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},n.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,f(n)?"["+n.join("+")+"]":n))},n.prototype.reverse=function(){return this.toCollection().reverse()},n.prototype.mapToClass=function(n){this.schema.mappedClass=n;var t=function(t){if(!t)return t;var r=Object.create(n.prototype);for(var e in t)if(h(t,e))try{r[e]=t[e]}catch(n){}return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),n},n.prototype.defineClass=function(){return this.mapToClass((function(n){c(this,n)}))},n.prototype.add=function(n,t){var r=this,e=this.schema.primKey,i=e.keyPath,u=n;return i&&e.auto&&(u=Ct(i)(n)),this._trans("readwrite",(function(n){return r.core.mutate({trans:n,type:"add",keys:null!=t?[t]:null,values:[u]})})).then((function(n){return n.numFailures?qn.reject(n.failures[0]):n.lastResult})).then((function(t){if(i)try{S(n,i,t)}catch(n){}return t}))},n.prototype.update=function(n,t){if("object"!=typeof n||f(n))return this.where(":id").equals(n).modify(t);var r=j(n,this.schema.primKey.keyPath);if(void 0===r)return gt(new en.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?a(t).forEach((function(r){S(n,r,t[r])})):t(n,{value:n,primKey:r})}catch(n){}return this.where(":id").equals(r).modify(t)},n.prototype.put=function(n,t){var r=this,e=this.schema.primKey,i=e.keyPath,u=n;return i&&e.auto&&(u=Ct(i)(n)),this._trans("readwrite",(function(n){return r.core.mutate({trans:n,type:"put",values:[u],keys:null!=t?[t]:null})})).then((function(n){return n.numFailures?qn.reject(n.failures[0]):n.lastResult})).then((function(t){if(i)try{S(n,i,t)}catch(n){}return t}))},n.prototype.delete=function(n){var t=this;return this._trans("readwrite",(function(r){return t.core.mutate({trans:r,type:"delete",keys:[n]})})).then((function(n){return n.numFailures?qn.reject(n.failures[0]):void 0}))},n.prototype.clear=function(){var n=this;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"deleteRange",range:Dt})})).then((function(n){return n.numFailures?qn.reject(n.failures[0]):void 0}))},n.prototype.bulkGet=function(n){var t=this;return this._trans("readonly",(function(r){return t.core.getMany({keys:n,trans:r}).then((function(n){return n.map((function(n){return t.hook.reading.fire(n)}))}))}))},n.prototype.bulkAdd=function(n,t,r){var e=this,i=Array.isArray(t)?t:void 0,u=(r=r||(i?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",(function(t){var r=e.schema.primKey,o=r.auto,a=r.keyPath;if(a&&i)throw new en.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==n.length)throw new en.InvalidArgument("Arguments objects and keys must have the same length");var f=n.length,c=a&&o?n.map(Ct(a)):n;return e.core.mutate({trans:t,type:"add",keys:i,values:c,wantResults:u}).then((function(n){var t=n.numFailures;if(0===t)return u?n.results:n.lastResult;throw new nn(e.name+".bulkAdd(): "+t+" of "+f+" operations failed",n.failures)}))}))},n.prototype.bulkPut=function(n,t,r){var e=this,i=Array.isArray(t)?t:void 0,u=(r=r||(i?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",(function(t){var r=e.schema.primKey,o=r.auto,a=r.keyPath;if(a&&i)throw new en.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==n.length)throw new en.InvalidArgument("Arguments objects and keys must have the same length");var f=n.length,c=a&&o?n.map(Ct(a)):n;return e.core.mutate({trans:t,type:"put",keys:i,values:c,wantResults:u}).then((function(n){var t=n.numFailures;if(0===t)return u?n.results:n.lastResult;throw new nn(e.name+".bulkPut(): "+t+" of "+f+" operations failed",n.failures)}))}))},n.prototype.bulkDelete=function(n){var t=this,r=n.length;return this._trans("readwrite",(function(r){return t.core.mutate({trans:r,type:"delete",keys:n})})).then((function(n){var e=n.numFailures;if(0===e)return n.lastResult;throw new nn(t.name+".bulkDelete(): "+e+" of "+r+" operations failed",n.failures)}))},n}();function Tt(n){var t={},r=function(r,e){if(e){for(var i=arguments.length,u=new Array(i-1);--i;)u[i-1]=arguments[i];return t[r].subscribe.apply(null,u),n}if("string"==typeof r)return t[r]};r.addEventType=u;for(var e=1,i=arguments.length;e<i;++e)u(arguments[e]);return r;function u(n,e,i){if("object"==typeof n)return o(n);e||(e=dn),i||(i=an);var u={subscribers:[],fire:i,subscribe:function(n){-1===u.subscribers.indexOf(n)&&(u.subscribers.push(n),u.fire=e(u.fire,n))},unsubscribe:function(n){u.subscribers=u.subscribers.filter((function(t){return t!==n})),u.fire=u.subscribers.reduce(e,i)}};return t[n]=r[n]=u,u}function o(n){a(n).forEach((function(t){var r=n[t];if(f(r))u(t,n[t][0],n[t][1]);else{if("asap"!==r)throw new en.InvalidArgument("Invalid event config");var e=u(t,fn,(function(){for(var n=arguments.length,t=new Array(n);n--;)t[n]=arguments[n];e.subscribers.forEach((function(n){E((function(){n.apply(null,t)}))}))}))}}))}}function Rt(n,t){return p(t).from({prototype:n}),t}function Bt(n,t){return!(n.filter||n.algorithm||n.or)&&(t?n.justLimit:!n.replayFilter)}function Mt(n,t){n.filter=Ot(n.filter,t)}function Kt(n,t,r){var e=n.replayFilter;n.replayFilter=e?function(){return Ot(e(),t())}:t,n.justLimit=r&&!e}function Nt(n,t){if(n.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(n.index);if(!r)throw new en.Schema("KeyPath "+n.index+" on object store "+t.name+" is not indexed");return r}function qt(n,t,r){var e=Nt(n,t.schema);return t.openCursor({trans:r,values:!n.keysOnly,reverse:"prev"===n.dir,unique:!!n.unique,query:{index:e,range:n.range}})}function Ft(n,t,r,e){var i=n.replayFilter?Ot(n.filter,n.replayFilter()):n.filter;if(n.or){var u={},o=function(n,r,e){if(!i||i(r,e,(function(n){return r.stop(n)}),(function(n){return r.fail(n)}))){var o=r.primaryKey,a=""+o;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(o)),h(u,a)||(u[a]=!0,t(n,r,e))}};return Promise.all([n.or._iterate(o,r),Ut(qt(n,e,r),n.algorithm,o,!n.keysOnly&&n.valueMapper)])}return Ut(qt(n,e,r),Ot(n.algorithm,i),t,!n.keysOnly&&n.valueMapper)}function Ut(n,t,r,e){var i=Zn(e?function(n,t,i){return r(e(n),t,i)}:r);return n.then((function(n){if(n)return n.start((function(){var r=function(){return n.continue()};t&&!t(n,(function(n){return r=n}),(function(t){n.stop(t),r=an}),(function(t){n.fail(t),r=an}))||i(n.value,n,(function(n){return r=n})),r()}))}))}function _t(n,t){try{var r=Lt(n),e=Lt(t);if(r!==e)return"Array"===r?1:"Array"===e?-1:"binary"===r?1:"binary"===e?-1:"string"===r?1:"string"===e?-1:"Date"===r?1:"Date"!==e?NaN:-1;switch(r){case"number":case"Date":case"string":return n>t?1:n<t?-1:0;case"binary":return function(n,t){for(var r=n.length,e=t.length,i=r<e?r:e,u=0;u<i;++u)if(n[u]!==t[u])return n[u]<t[u]?-1:1;return r===e?0:r<e?-1:1}(Ht(n),Ht(t));case"Array":return function(n,t){for(var r=n.length,e=t.length,i=r<e?r:e,u=0;u<i;++u){var o=_t(n[u],t[u]);if(0!==o)return o}return r===e?0:r<e?-1:1}(n,t)}}catch(n){}return NaN}function Lt(n){var t=typeof n;if("object"!==t)return t;if(ArrayBuffer.isView(n))return"binary";var r=K(n);return"ArrayBuffer"===r?"binary":r}function Ht(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}var Vt=function(){function n(){}return n.prototype._read=function(n,t){var r=this._ctx;return r.error?r.table._trans(null,gt.bind(null,r.error)):r.table._trans("readonly",n).then(t)},n.prototype._write=function(n){var t=this._ctx;return t.error?t.table._trans(null,gt.bind(null,t.error)):t.table._trans("readwrite",n,"locked")},n.prototype._addAlgorithm=function(n){var t=this._ctx;t.algorithm=Ot(t.algorithm,n)},n.prototype._iterate=function(n,t){return Ft(this._ctx,n,t,this._ctx.table.core)},n.prototype.clone=function(n){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return n&&c(r,n),t._ctx=r,t},n.prototype.raw=function(){return this._ctx.valueMapper=null,this},n.prototype.each=function(n){var t=this._ctx;return this._read((function(r){return Ft(t,n,r,t.table.core)}))},n.prototype.count=function(n){var t=this;return this._read((function(n){var r=t._ctx,e=r.table.core;if(Bt(r,!0))return e.count({trans:n,query:{index:Nt(r,e.schema),range:r.range}}).then((function(n){return Math.min(n,r.limit)}));var i=0;return Ft(r,(function(){return++i,!1}),n,e).then((function(){return i}))})).then(n)},n.prototype.sortBy=function(n,t){var r=n.split(".").reverse(),e=r[0],i=r.length-1;function u(n,t){return t?u(n[r[t]],t-1):n[e]}var o="next"===this._ctx.dir?1:-1;function a(n,t){var r=u(n,i),e=u(t,i);return r<e?-o:r>e?o:0}return this.toArray((function(n){return n.sort(a)})).then(t)},n.prototype.toArray=function(n){var t=this;return this._read((function(n){var r=t._ctx;if("next"===r.dir&&Bt(r,!0)&&r.limit>0){var e=r.valueMapper,i=Nt(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then((function(n){var t=n.result;return e?t.map(e):t}))}var u=[];return Ft(r,(function(n){return u.push(n)}),n,r.table.core).then((function(){return u}))}),n)},n.prototype.offset=function(n){var t=this._ctx;return n<=0||(t.offset+=n,Bt(t)?Kt(t,(function(){var t=n;return function(n,r){return 0===t||(1===t?(--t,!1):(r((function(){n.advance(t),t=0})),!1))}})):Kt(t,(function(){var t=n;return function(){return--t<0}}))),this},n.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Kt(this._ctx,(function(){var t=n;return function(n,r,e){return--t<=0&&r(e),t>=0}}),!0),this},n.prototype.until=function(n,t){return Mt(this._ctx,(function(r,e,i){return!n(r.value)||(e(i),t)})),this},n.prototype.first=function(n){return this.limit(1).toArray((function(n){return n[0]})).then(n)},n.prototype.last=function(n){return this.reverse().first(n)},n.prototype.filter=function(n){var t;return Mt(this._ctx,(function(t){return n(t.value)})),(t=this._ctx).isMatch=Ot(t.isMatch,n),this},n.prototype.and=function(n){return this.filter(n)},n.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},n.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},n.prototype.desc=function(){return this.reverse()},n.prototype.eachKey=function(n){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,r){n(r.key,r)}))},n.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},n.prototype.eachPrimaryKey=function(n){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,r){n(r.primaryKey,r)}))},n.prototype.keys=function(n){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each((function(n,t){r.push(t.key)})).then((function(){return r})).then(n)},n.prototype.primaryKeys=function(n){var t=this._ctx;if("next"===t.dir&&Bt(t,!0)&&t.limit>0)return this._read((function(n){var r=Nt(t,t.table.core.schema);return t.table.core.query({trans:n,values:!1,limit:t.limit,query:{index:r,range:t.range}})})).then((function(n){return n.result})).then(n);t.keysOnly=!t.isMatch;var r=[];return this.each((function(n,t){r.push(t.primaryKey)})).then((function(){return r})).then(n)},n.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},n.prototype.firstKey=function(n){return this.limit(1).keys((function(n){return n[0]})).then(n)},n.prototype.lastKey=function(n){return this.reverse().firstKey(n)},n.prototype.distinct=function(){var n=this._ctx,t=n.index&&n.table.schema.idxByName[n.index];if(!t||!t.multi)return this;var r={};return Mt(this._ctx,(function(n){var t=n.primaryKey.toString(),e=h(r,t);return r[t]=!0,!e})),this},n.prototype.modify=function(n){var t=this,r=this._ctx;return this._write((function(e){var i;if("function"==typeof n)i=n;else{var u=a(n),o=u.length;i=function(t){for(var r=!1,e=0;e<o;++e){var i=u[e],a=n[i];j(t,i)!==a&&(S(t,i,a),r=!0)}return r}}var f=r.table.core,c=f.schema.primaryKey,s=c.outbound,l=c.extractKey,h=t.db._options.modifyChunkSize||200,v=[],d=0,y=[],p=function(n,t){var r=t.failures;d+=n-t.numFailures;for(var e=0,i=a(r);e<i.length;e++)v.push(r[i[e]])};return t.clone().primaryKeys().then((function(t){var u=function(o){var a=Math.min(h,t.length-o);return f.getMany({trans:e,keys:t.slice(o,o+a),cache:"immutable"}).then((function(c){for(var v=[],d=[],y=s?[]:null,w=[],m=0;m<a;++m){var g=c[m],b={value:R(g),primKey:t[o+m]};!1!==i.call(b,b.value,b)&&(null==b.value?w.push(t[o+m]):s||0===_t(l(g),l(b.value))?(d.push(b.value),s&&y.push(t[o+m])):(w.push(t[o+m]),v.push(b.value)))}var x=Bt(r)&&r.limit===1/0&&("function"!=typeof n||n===Wt)&&{index:r.index,range:r.range};return Promise.resolve(v.length>0&&f.mutate({trans:e,type:"add",values:v}).then((function(n){for(var t in n.failures)w.splice(parseInt(t),1);p(v.length,n)}))).then((function(){return(d.length>0||x&&"object"==typeof n)&&f.mutate({trans:e,type:"put",keys:y,values:d,criteria:x,changeSpec:"function"!=typeof n&&n}).then((function(n){return p(d.length,n)}))})).then((function(){return(w.length>0||x&&n===Wt)&&f.mutate({trans:e,type:"delete",keys:w,criteria:x}).then((function(n){return p(w.length,n)}))})).then((function(){return t.length>o+a&&u(o+h)}))}))};return u(0).then((function(){if(v.length>0)throw new Z("Error modifying one or more objects",v,d,y);return t.length}))}))}))},n.prototype.delete=function(){var n=this._ctx,t=n.range;return Bt(n)&&(n.isPrimKey&&!St||3===t.type)?this._write((function(r){var e=t;return n.table.core.count({trans:r,query:{index:n.table.core.schema.primaryKey,range:e}}).then((function(t){return n.table.core.mutate({trans:r,type:"deleteRange",range:e}).then((function(n){var r=n.failures,e=n.numFailures;if(e)throw new Z("Could not delete some values",Object.keys(r).map((function(n){return r[n]})),t-e);return t-e}))}))})):this.modify(Wt)},n}(),Wt=function(n,t){return t.value=null};function zt(n,t){return n<t?-1:n===t?0:1}function Gt(n,t){return n>t?-1:n===t?0:1}function $t(n,t,r){var e=n instanceof nr?new n.Collection(n):n;return e._ctx.error=r?new r(t):new TypeError(t),e}function Jt(n){return new n.Collection(n,(function(){return Zt("")})).limit(0)}function Yt(n,t,r,e,i,u){for(var o=Math.min(n.length,e.length),a=-1,f=0;f<o;++f){var c=t[f];if(c!==e[f])return i(n[f],r[f])<0?n.substr(0,f)+r[f]+r.substr(f+1):i(n[f],e[f])<0?n.substr(0,f)+e[f]+r.substr(f+1):a>=0?n.substr(0,a)+t[a]+r.substr(a+1):null;i(n[f],c)<0&&(a=f)}return o<e.length&&"next"===u?n+r.substr(n.length):o<n.length&&"prev"===u?n.substr(0,r.length):a<0?null:n.substr(0,a)+e[a]+r.substr(a+1)}function Qt(n,t,r,e){var i,u,o,a,f,c,s,l=r.length;if(!r.every((function(n){return"string"==typeof n})))return $t(n,"String expected.");function h(n){i=function(n){return"next"===n?function(n){return n.toUpperCase()}:function(n){return n.toLowerCase()}}(n),u=function(n){return"next"===n?function(n){return n.toLowerCase()}:function(n){return n.toUpperCase()}}(n),o="next"===n?zt:Gt;var t=r.map((function(n){return{lower:u(n),upper:i(n)}})).sort((function(n,t){return o(n.lower,t.lower)}));a=t.map((function(n){return n.upper})),f=t.map((function(n){return n.lower})),c=n,s="next"===n?"":e}h("next");var v=new n.Collection(n,(function(){return Xt(a[0],f[l-1]+e)}));v._ondirectionchange=function(n){h(n)};var d=0;return v._addAlgorithm((function(n,r,e){var i=n.key;if("string"!=typeof i)return!1;var h=u(i);if(t(h,f,d))return!0;for(var v=null,y=d;y<l;++y){var p=Yt(i,h,a[y],f[y],o,c);null===p&&null===v?d=y+1:(null===v||o(v,p)>0)&&(v=p)}return r(null!==v?function(){n.continue(v+s)}:e),!1})),v}function Xt(n,t,r,e){return{type:2,lower:n,upper:t,lowerOpen:r,upperOpen:e}}function Zt(n){return{type:1,lower:n,upper:n}}var nr=function(){function n(){}return Object.defineProperty(n.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),n.prototype.between=function(n,t,r,e){r=!1!==r,e=!0===e;try{return this._cmp(n,t)>0||0===this._cmp(n,t)&&(r||e)&&(!r||!e)?Jt(this):new this.Collection(this,(function(){return Xt(n,t,!r,!e)}))}catch(n){return $t(this,kt)}},n.prototype.equals=function(n){return null==n?$t(this,kt):new this.Collection(this,(function(){return Zt(n)}))},n.prototype.above=function(n){return null==n?$t(this,kt):new this.Collection(this,(function(){return Xt(n,void 0,!0)}))},n.prototype.aboveOrEqual=function(n){return null==n?$t(this,kt):new this.Collection(this,(function(){return Xt(n,void 0,!1)}))},n.prototype.below=function(n){return null==n?$t(this,kt):new this.Collection(this,(function(){return Xt(void 0,n,!1,!0)}))},n.prototype.belowOrEqual=function(n){return null==n?$t(this,kt):new this.Collection(this,(function(){return Xt(void 0,n)}))},n.prototype.startsWith=function(n){return"string"!=typeof n?$t(this,"String expected."):this.between(n,n+xt,!0,!0)},n.prototype.startsWithIgnoreCase=function(n){return""===n?this.startsWith(n):Qt(this,(function(n,t){return 0===n.indexOf(t[0])}),[n],xt)},n.prototype.equalsIgnoreCase=function(n){return Qt(this,(function(n,t){return n===t[0]}),[n],"")},n.prototype.anyOfIgnoreCase=function(){var n=U.apply(F,arguments);return 0===n.length?Jt(this):Qt(this,(function(n,t){return-1!==t.indexOf(n)}),n,"")},n.prototype.startsWithAnyOfIgnoreCase=function(){var n=U.apply(F,arguments);return 0===n.length?Jt(this):Qt(this,(function(n,t){return t.some((function(t){return 0===n.indexOf(t)}))}),n,xt)},n.prototype.anyOf=function(){var n=this,t=U.apply(F,arguments),r=this._cmp;try{t.sort(r)}catch(n){return $t(this,kt)}if(0===t.length)return Jt(this);var e=new this.Collection(this,(function(){return Xt(t[0],t[t.length-1])}));e._ondirectionchange=function(e){t.sort(r="next"===e?n._ascending:n._descending)};var i=0;return e._addAlgorithm((function(n,e,u){for(var o=n.key;r(o,t[i])>0;)if(++i===t.length)return e(u),!1;return 0===r(o,t[i])||(e((function(){n.continue(t[i])})),!1)})),e},n.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},n.prototype.noneOf=function(){var n=U.apply(F,arguments);if(0===n.length)return new this.Collection(this);try{n.sort(this._ascending)}catch(n){return $t(this,kt)}var t=n.reduce((function(n,t){return n?n.concat([[n[n.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},n.prototype.inAnyRange=function(n,t){var r=this,e=this._cmp,i=this._ascending,u=this._descending,o=this._min,a=this._max;if(0===n.length)return Jt(this);if(!n.every((function(n){return void 0!==n[0]&&void 0!==n[1]&&i(n[0],n[1])<=0})))return $t(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",en.InvalidArgument);var f,c=!t||!1!==t.includeLowers,s=t&&!0===t.includeUppers,l=i;function h(n,t){return l(n[0],t[0])}try{(f=n.reduce((function(n,t){for(var r=0,i=n.length;r<i;++r){var u=n[r];if(e(t[0],u[1])<0&&e(t[1],u[0])>0){u[0]=o(u[0],t[0]),u[1]=a(u[1],t[1]);break}}return r===i&&n.push(t),n}),[])).sort(h)}catch(n){return $t(this,kt)}var v=0,d=s?function(n){return i(n,f[v][1])>0}:function(n){return i(n,f[v][1])>=0},y=c?function(n){return u(n,f[v][0])>0}:function(n){return u(n,f[v][0])>=0},p=d,w=new this.Collection(this,(function(){return Xt(f[0][0],f[f.length-1][1],!c,!s)}));return w._ondirectionchange=function(n){"next"===n?(p=d,l=i):(p=y,l=u),f.sort(h)},w._addAlgorithm((function(n,t,e){for(var u=n.key;p(u);)if(++v===f.length)return t(e),!1;return!!function(n){return!d(n)&&!y(n)}(u)||(0===r._cmp(u,f[v][1])||0===r._cmp(u,f[v][0])||t((function(){n.continue(l===i?f[v][0]:f[v][1])})),!1)})),w},n.prototype.startsWithAnyOf=function(){var n=U.apply(F,arguments);return n.every((function(n){return"string"==typeof n}))?0===n.length?Jt(this):this.inAnyRange(n.map((function(n){return[n,n+xt]}))):$t(this,"startsWithAnyOf() only works with strings")},n}();function tr(n){return Zn((function(t){return rr(t),n(t.target.error),!1}))}function rr(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var er=Tt(null,"storagemutated"),ir=function(){function n(){}return n.prototype._lock=function(){return k(!Bn.global),++this._reculock,1!==this._reculock||Bn.global||(Bn.lockOwnerFor=this),this},n.prototype._unlock=function(){if(k(!Bn.global),0==--this._reculock)for(Bn.global||(Bn.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var n=this._blockedFuncs.shift();try{dt(n[1],n[0])}catch(n){}}return this},n.prototype._locked=function(){return this._reculock&&Bn.lockOwnerFor!==this},n.prototype.create=function(n){var t=this;if(!this.mode)return this;var r=this.db.idbdb,e=this.db._state.dbOpenError;if(k(!this.idbtrans),!n&&!r)switch(e&&e.name){case"DatabaseClosedError":throw new en.DatabaseClosed(e);case"MissingAPIError":throw new en.MissingAPI(e.message,e);default:throw new en.OpenFailed(e)}if(!this.active)throw new en.TransactionInactive;return k(null===this._completion._state),(n=this.idbtrans=n||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Zn((function(r){rr(r),t._reject(n.error)})),n.onabort=Zn((function(r){rr(r),t.active&&t._reject(new en.Abort(n.error)),t.active=!1,t.on("abort").fire(r)})),n.oncomplete=Zn((function(){t.active=!1,t._resolve(),"mutatedParts"in n&&er.storagemutated.fire(n.mutatedParts)})),this},n.prototype._promise=function(n,t,r){var e=this;if("readwrite"===n&&"readwrite"!==this.mode)return gt(new en.ReadOnly("Transaction is readonly"));if(!this.active)return gt(new en.TransactionInactive);if(this._locked())return new qn((function(i,u){e._blockedFuncs.push([function(){e._promise(n,t,r).then(i,u)},Bn])}));if(r)return ot((function(){var n=new qn((function(n,r){e._lock();var i=t(n,r,e);i&&i.then&&i.then(n,r)}));return n.finally((function(){return e._unlock()})),n._lib=!0,n}));var i=new qn((function(n,r){var i=t(n,r,e);i&&i.then&&i.then(n,r)}));return i._lib=!0,i},n.prototype._root=function(){return this.parent?this.parent._root():this},n.prototype.waitFor=function(n){var t=this._root(),r=qn.resolve(n);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return r}));else{t._waitingFor=r,t._waitingQueue=[];var e=t.idbtrans.objectStore(t.storeNames[0]);!function n(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(e.get(-1/0).onsuccess=n)}()}var i=t._waitingFor;return new qn((function(n,e){r.then((function(r){return t._waitingQueue.push(Zn(n.bind(null,r)))}),(function(n){return t._waitingQueue.push(Zn(e.bind(null,n)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},n.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new en.Abort))},n.prototype.table=function(n){var t=this._memoizedTables||(this._memoizedTables={});if(h(t,n))return t[n];var r=this.schema[n];if(!r)throw new en.NotFound("Table "+n+" not part of transaction");var e=new this.db.Table(n,r,this);return e.core=this.db.core.table(n),t[n]=e,e},n}();function ur(n,t,r,e,i,u,o){return{name:n,keyPath:t,unique:r,multi:e,auto:i,compound:u,src:(r&&!o?"&":"")+(e?"*":"")+(i?"++":"")+or(t)}}function or(n){return"string"==typeof n?n:n?"["+[].join.call(n,"+")+"]":""}function ar(n,t,r){return{name:n,primKey:t,indexes:r,mappedClass:null,idxByName:A(r,(function(n){return[n.name,n]}))}}var fr=function(n){try{return n.only([[]]),fr=function(){return[[]]},[[]]}catch(n){return fr=function(){return xt},xt}};function cr(n){return null==n?function(){}:"string"==typeof n?function(n){return 1===n.split(".").length?function(t){return t[n]}:function(t){return j(t,n)}}(n):function(t){return j(t,n)}}function sr(n){return[].slice.call(n)}var lr=0;function hr(n){return null==n?":id":"string"==typeof n?n:"["+n.join("+")+"]"}function vr(n,t,r){function e(n){if(3===n.type)return null;if(4===n.type)throw new Error("Cannot convert never type to IDBKeyRange");var r=n.lower,e=n.upper,i=n.lowerOpen,u=n.upperOpen;return void 0===r?void 0===e?null:t.upperBound(e,!!u):void 0===e?t.lowerBound(r,!!i):t.bound(r,e,!!i,!!u)}var i=function(n,t){var r=sr(n.objectStoreNames);return{schema:{name:n.name,tables:r.map((function(n){return t.objectStore(n)})).map((function(n){var t=n.keyPath,r=n.autoIncrement,e=f(t),i={},u={name:n.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==t,compound:e,keyPath:t,autoIncrement:r,unique:!0,extractKey:cr(t)},indexes:sr(n.indexNames).map((function(t){return n.index(t)})).map((function(n){var t=n.unique,r=n.multiEntry,e=n.keyPath,u={name:n.name,compound:f(e),keyPath:e,unique:t,multiEntry:r,extractKey:cr(e)};return i[hr(e)]=u,u})),getIndexByKeyPath:function(n){return i[hr(n)]}};return i[":id"]=u.primaryKey,null!=t&&(i[hr(t)]=u.primaryKey),u}))},hasGetAll:r.length>0&&"getAll"in t.objectStore(r[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(n,r),u=i.schema,o=i.hasGetAll,a=u.tables.map((function(n){return function(n){var t=n.name;return{name:t,schema:n,mutate:function(n){var r=n.trans,i=n.type,u=n.keys,o=n.values,a=n.range;return new Promise((function(n){n=Zn(n);var f=r.objectStore(t),c=null==f.keyPath,s="put"===i||"add"===i;if(!s&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var l,h=(u||o||{length:1}).length;if(u&&o&&u.length!==o.length)throw new Error("Given keys array must have same length as given values array.");if(0===h)return n({numFailures:0,failures:{},results:[],lastResult:void 0});var v=[],d=[],y=0,p=function(n){++y,rr(n)};if("deleteRange"===i){if(4===a.type)return n({numFailures:y,failures:d,results:[],lastResult:void 0});v.push(l=3===a.type?f.clear():f.delete(e(a)))}else{var w=s?c?[o,u]:[o,null]:[u,null],m=w[0],g=w[1];if(s)for(var b=0;b<h;++b)v.push(l=g&&void 0!==g[b]?f[i](m[b],g[b]):f[i](m[b])),l.onerror=p;else for(b=0;b<h;++b)v.push(l=f[i](m[b])),l.onerror=p}var x=function(t){var r=t.target.result;v.forEach((function(n,t){return null!=n.error&&(d[t]=n.error)})),n({numFailures:y,failures:d,results:"delete"===i?u:v.map((function(n){return n.result})),lastResult:r})};l.onerror=function(n){p(n),x(n)},l.onsuccess=x}))},getMany:function(n){var r=n.trans,e=n.keys;return new Promise((function(n,i){n=Zn(n);for(var u,o=r.objectStore(t),a=e.length,f=new Array(a),c=0,s=0,l=function(t){var r=t.target;f[r._pos]=r.result,++s===c&&n(f)},h=tr(i),v=0;v<a;++v)null!=e[v]&&((u=o.get(e[v]))._pos=v,u.onsuccess=l,u.onerror=h,++c);0===c&&n(f)}))},get:function(n){var r=n.trans,e=n.key;return new Promise((function(n,i){n=Zn(n);var u=r.objectStore(t).get(e);u.onsuccess=function(t){return n(t.target.result)},u.onerror=tr(i)}))},query:function(n){return function(r){return new Promise((function(i,u){i=Zn(i);var o=r.values,a=r.limit,f=r.query,c=a===1/0?void 0:a,s=f.index,l=f.range,h=r.trans.objectStore(t),v=s.isPrimaryKey?h:h.index(s.name),d=e(l);if(0===a)return i({result:[]});if(n){var y=o?v.getAll(d,c):v.getAllKeys(d,c);y.onsuccess=function(n){return i({result:n.target.result})},y.onerror=tr(u)}else{var p=0,w=o||!("openKeyCursor"in v)?v.openCursor(d):v.openKeyCursor(d),m=[];w.onsuccess=function(){var n=w.result;return n?(m.push(o?n.value:n.primaryKey),++p===a?i({result:m}):void n.continue()):i({result:m})},w.onerror=tr(u)}}))}}(o),openCursor:function(n){var r=n.trans,i=n.values,u=n.query,o=n.reverse,a=n.unique;return new Promise((function(n,f){n=Zn(n);var c=u.index,s=u.range,l=r.objectStore(t),h=c.isPrimaryKey?l:l.index(c.name),v=o?a?"prevunique":"prev":a?"nextunique":"next",d=i||!("openKeyCursor"in h)?h.openCursor(e(s),v):h.openKeyCursor(e(s),v);d.onerror=tr(f),d.onsuccess=Zn((function(){var t=d.result;if(t){t.___id=++lr,t.done=!1;var e=t.continue.bind(t),i=t.continuePrimaryKey;i&&(i=i.bind(t));var u=t.advance.bind(t),o=function(){throw new Error("Cursor not stopped")};t.trans=r,t.stop=t.continue=t.continuePrimaryKey=t.advance=function(){throw new Error("Cursor not started")},t.fail=Zn(f),t.next=function(){var n=this,t=1;return this.start((function(){return t--?n.continue():n.stop()})).then((function(){return n}))},t.start=function(n){var r=new Promise((function(n,r){n=Zn(n),d.onerror=tr(r),t.fail=r,t.stop=function(r){t.stop=t.continue=t.continuePrimaryKey=t.advance=o,n(r)}})),a=function(){if(d.result)try{n()}catch(n){t.fail(n)}else t.done=!0,t.start=function(){throw new Error("Cursor behind last entry")},t.stop()};return d.onsuccess=Zn((function(){d.onsuccess=a,a()})),t.continue=e,t.continuePrimaryKey=i,t.advance=u,a(),r},n(t)}else n(null)}),f)}))},count:function(n){var r=n.query,i=n.trans,u=r.index,o=r.range;return new Promise((function(n,r){var a=i.objectStore(t),f=u.isPrimaryKey?a:a.index(u.name),c=e(o),s=c?f.count(c):f.count();s.onsuccess=Zn((function(t){return n(t.target.result)})),s.onerror=tr(r)}))}}}(n)})),c={};return a.forEach((function(n){return c[n.name]=n})),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(n){if(!c[n])throw new Error("Table '"+n+"' not found");return c[n]},MIN_KEY:-1/0,MAX_KEY:fr(t),schema:u}}function dr(n,t){var r=n._novip,e=function(n,t,r,e){return{dbcore:function(n,t){return t.reduce((function(n,t){var r=t.create;return i(i({},n),r(n))}),n)}(vr(t,r.IDBKeyRange,e),n.dbcore)}}(r._middlewares,t.db,r._deps,t);r.core=e.dbcore,r.tables.forEach((function(n){var t=n.name;r.core.schema.tables.some((function(n){return n.name===t}))&&(n.core=r.core.table(t),r[t]instanceof r.Table&&(r[t].core=n.core))}))}function yr(n,t,r,e){var i=n._novip;r.forEach((function(n){var r=e[n];t.forEach((function(t){var e=m(t,n);(!e||"value"in e&&void 0===e.value)&&(t===i.Transaction.prototype||t instanceof i.Transaction?y(t,n,{get:function(){return this.table(n)},set:function(t){d(this,n,{value:t,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new i.Table(n,r))}))}))}function pr(n,t){var r=n._novip;t.forEach((function(n){for(var t in n)n[t]instanceof r.Table&&delete n[t]}))}function wr(n,t){return n._cfg.version-t._cfg.version}function mr(n,t){var r,e={del:[],add:[],change:[]};for(r in n)t[r]||e.del.push(r);for(r in t){var i=n[r],u=t[r];if(i){var o={name:r,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||i.primKey.auto!==u.primKey.auto&&!At)o.recreate=!0,e.change.push(o);else{var a=i.idxByName,f=u.idxByName,c=void 0;for(c in a)f[c]||o.del.push(c);for(c in f){var s=a[c],l=f[c];s?s.src!==l.src&&o.change.push(l):o.add.push(l)}(o.del.length>0||o.add.length>0||o.change.length>0)&&e.change.push(o)}}else e.add.push([r,u])}return e}function gr(n,t,r,e){var i=n.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return e.forEach((function(n){return br(i,n)})),i}function br(n,t){n.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function xr(n,t,r){var e={};return b(t.objectStoreNames,0).forEach((function(n){for(var t=r.objectStore(n),i=t.keyPath,u=ur(or(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),o=[],a=0;a<t.indexNames.length;++a){var f=t.index(t.indexNames[a]),c=ur(f.name,i=f.keyPath,!!f.unique,!!f.multiEntry,!1,i&&"string"!=typeof i,!1);o.push(c)}e[n]=ar(n,u,o)})),e}function kr(n,t,r){for(var e=n._novip,i=r.db.objectStoreNames,u=0;u<i.length;++u){var a=i[u],f=r.objectStore(a);e._hasGetAll="getAll"in f;for(var c=0;c<f.indexNames.length;++c){var s=f.indexNames[c],l=f.index(s).keyPath,h="string"==typeof l?l:"["+b(l).join("+")+"]";if(t[a]){var v=t[a].idxByName[h];v&&(v.name=s,delete t[a].idxByName[h],t[a].idxByName[s]=v)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var Er=function(){function n(){}return n.prototype._parseStoresSpec=function(n,t){a(n).forEach((function(r){if(null!==n[r]){var e=n[r].split(",").map((function(n,t){var r=(n=n.trim()).replace(/([&*]|\+\+)/g,""),e=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return ur(r,e||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),f(e),0===t)})),i=e.shift();if(i.multi)throw new en.Schema("Primary key cannot be multi-valued");e.forEach((function(n){if(n.auto)throw new en.Schema("Only primary key can be marked as autoIncrement (++)");if(!n.keyPath)throw new en.Schema("Index must have a name and cannot be an empty string")})),t[r]=ar(r,i,e)}}))},n.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,n):n;var r={},e={};return t._versions.forEach((function(n){c(r,n._cfg.storesSource),e=n._cfg.dbschema={},n._parseStoresSpec(r,e)})),t._dbSchema=e,pr(t,[t._allTables,t,t.Transaction.prototype]),yr(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],a(e),e),t._storeNames=a(e),this},n.prototype.upgrade=function(n){return this._cfg.contentUpgrade=yn(this._cfg.contentUpgrade||an,n),this},n}();function Ar(n,t){var r=n._dbNamesDB;return r||(r=n._dbNamesDB=new Jr("__dbnames",{addons:[],indexedDB:n,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function jr(n){return n&&"function"==typeof n.databases}function Sr(n,t){var r=n.indexedDB,e=n.IDBKeyRange;!jr(r)&&"__dbnames"!==t&&Ar(r,e).delete(t).catch(an)}function Pr(n){return ot((function(){return Bn.letThrough=!0,n()}))}function Or(){var n;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var r=function(){return indexedDB.databases().finally(t)};n=setInterval(r,100),r()})).finally((function(){return clearInterval(n)})):Promise.resolve()}function Dr(n){var t=n._state,r=n._deps.indexedDB;if(t.isBeingOpened||n.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?gt(t.dbOpenError):n}));L&&(t.openCanceller._stackHolder=z()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var e=t.openCanceller;function i(){if(t.openCanceller!==e)throw new en.DatabaseClosed("db.open() was cancelled")}var u=t.dbReadyResolve,o=null,f=!1;return qn.race([e,("undefined"==typeof navigator?qn.resolve():Or()).then((function(){return new qn((function(e,u){if(i(),!r)throw new en.MissingAPI;var c=n.name,s=t.autoSchema?r.open(c):r.open(c,Math.round(10*n.verno));if(!s)throw new en.MissingAPI;s.onerror=tr(u),s.onblocked=Zn(n._fireOnBlocked),s.onupgradeneeded=Zn((function(e){if(o=s.transaction,t.autoSchema&&!n._options.allowEmptyDB){s.onerror=rr,o.abort(),s.result.close();var i=r.deleteDatabase(c);i.onsuccess=i.onerror=Zn((function(){u(new en.NoSuchDatabase("Database "+c+" doesnt exist"))}))}else{o.onerror=tr(u);var l=e.oldVersion>Math.pow(2,62)?0:e.oldVersion;f=l<1,n._novip.idbdb=s.result,function(n,t,r,e){var i=n._dbSchema,u=n._createTransaction("readwrite",n._storeNames,i);u.create(r),u._completion.catch(e);var o=u._reject.bind(u),f=Bn.transless||Bn;ot((function(){Bn.trans=u,Bn.transless=f,0===t?(a(i).forEach((function(n){gr(r,n,i[n].primKey,i[n].indexes)})),dr(n,r),qn.follow((function(){return n.on.populate.fire(u)})).catch(o)):function(n,t,r,e){var i=n._novip,u=[],o=i._versions,f=i._dbSchema=xr(0,i.idbdb,e),c=!1;return o.filter((function(n){return n._cfg.version>=t})).forEach((function(n){u.push((function(){var u=f,o=n._cfg.dbschema;kr(i,u,e),kr(i,o,e),f=i._dbSchema=o;var s=mr(u,o);s.add.forEach((function(n){gr(e,n[0],n[1].primKey,n[1].indexes)})),s.change.forEach((function(n){if(n.recreate)throw new en.Upgrade("Not yet support for changing primary key");var t=e.objectStore(n.name);n.add.forEach((function(n){return br(t,n)})),n.change.forEach((function(n){t.deleteIndex(n.name),br(t,n)})),n.del.forEach((function(n){return t.deleteIndex(n)}))}));var l=n._cfg.contentUpgrade;if(l&&n._cfg.version>t){dr(i,e),r._memoizedTables={},c=!0;var h=P(o);s.del.forEach((function(n){h[n]=u[n]})),pr(i,[i.Transaction.prototype]),yr(i,[i.Transaction.prototype],a(h),h),r.schema=h;var v,d=_(l);d&&at();var y=qn.follow((function(){if((v=l(r))&&d){var n=ft.bind(null,null);v.then(n,n)}}));return v&&"function"==typeof v.then?qn.resolve(v):y.then((function(){return v}))}})),u.push((function(t){c&&jt||function(n,t){[].slice.call(t.db.objectStoreNames).forEach((function(r){return null==n[r]&&t.db.deleteObjectStore(r)}))}(n._cfg.dbschema,t),pr(i,[i.Transaction.prototype]),yr(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),r.schema=i._dbSchema}))})),function n(){return u.length?qn.resolve(u.shift()(r.idbtrans)).then(n):qn.resolve()}().then((function(){var n,t;t=e,a(n=f).forEach((function(r){t.db.objectStoreNames.contains(r)||gr(t,r,n[r].primKey,n[r].indexes)}))}))}(n,t,u,r).catch(o)}))}(n,l/10,o,u)}}),u),s.onsuccess=Zn((function(){o=null;var r,i=n._novip.idbdb=s.result,u=b(i.objectStoreNames);if(u.length>0)try{var l=i.transaction(1===(r=u).length?r[0]:r,"readonly");t.autoSchema?function(n,t,r){var e=n._novip;e.verno=t.version/10;var i=e._dbSchema=xr(0,t,r);e._storeNames=b(t.objectStoreNames,0),yr(e,[e._allTables],a(i),i)}(n,i,l):(kr(n,n._dbSchema,l),function(n,t){var r=mr(xr(0,n.idbdb,t),n._dbSchema);return!(r.add.length||r.change.some((function(n){return n.add.length||n.change.length})))}(n,l)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),dr(n,l)}catch(n){}Et.push(n),i.onversionchange=Zn((function(r){t.vcFired=!0,n.on("versionchange").fire(r)})),i.onclose=Zn((function(t){n.on("close").fire(t)})),f&&function(n,t){var r=n.indexedDB,e=n.IDBKeyRange;!jr(r)&&"__dbnames"!==t&&Ar(r,e).put({name:t}).catch(an)}(n._deps,c),e()}),u)}))}))]).then((function(){return i(),t.onReadyBeingFired=[],qn.resolve(Pr((function(){return n.on.ready.fire(n.vip)}))).then((function r(){if(t.onReadyBeingFired.length>0){var e=t.onReadyBeingFired.reduce(yn,an);return t.onReadyBeingFired=[],qn.resolve(Pr((function(){return e(n.vip)}))).then(r)}}))})).finally((function(){t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((function(){return n})).catch((function(r){t.dbOpenError=r;try{o&&o.abort()}catch(n){}return e===t.openCanceller&&n._close(),gt(r)})).finally((function(){t.openComplete=!0,u()}))}function Cr(n){var t=function(t){return n.next(t)},r=i(t),e=i((function(t){return n.throw(t)}));function i(n){return function(t){var i=n(t),u=i.value;return i.done?u:u&&"function"==typeof u.then?u.then(r,e):f(u)?Promise.all(u).then(r,e):r(u)}}return i(t)()}function Ir(n,t,r){var e=arguments.length;if(e<2)throw new en.InvalidArgument("Too few arguments");for(var i=new Array(e-1);--e;)i[e-1]=arguments[e];r=i.pop();var u=D(i);return[n,u,r]}function Tr(n,t,r,e,i){return qn.resolve().then((function(){var u=Bn.transless||Bn,o=n._createTransaction(t,r,n._dbSchema,e),a={trans:o,transless:u};e?o.idbtrans=e.idbtrans:o.create();var f,c=_(i);c&&at();var s=qn.follow((function(){if(f=i.call(o,o))if(c){var n=ft.bind(null,null);f.then(n,n)}else"function"==typeof f.next&&"function"==typeof f.throw&&(f=Cr(f))}),a);return(f&&"function"==typeof f.then?qn.resolve(f).then((function(n){return o.active?n:gt(new en.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):s.then((function(){return f}))).then((function(n){return e&&o._resolve(),o._completion.then((function(){return n}))})).catch((function(n){return o._reject(n),gt(n)}))}))}function Rr(n,t,r){for(var e=f(n)?n.slice():[n],i=0;i<r;++i)e.push(t);return e}var Br={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return i(i({},n),{table:function(t){var r=n.table(t),e=r.schema,u={},o=[];function a(n,t,r){var e=hr(n),f=u[e]=u[e]||[],c=null==n?0:"string"==typeof n?1:n.length,s=t>0,l=i(i({},r),{isVirtual:s,keyTail:t,keyLength:c,extractKey:cr(n),unique:!s&&r.unique});return f.push(l),l.isPrimaryKey||o.push(l),c>1&&a(2===c?n[0]:n.slice(0,c-1),t+1,r),f.sort((function(n,t){return n.keyTail-t.keyTail})),l}var f=a(e.primaryKey.keyPath,0,e.primaryKey);u[":id"]=[f];for(var c=0,s=e.indexes;c<s.length;c++){var l=s[c];a(l.keyPath,0,l)}function h(t){var r,e,u=t.query.index;return u.isVirtual?i(i({},t),{query:{index:u,range:(r=t.query.range,e=u.keyTail,{type:1===r.type?2:r.type,lower:Rr(r.lower,r.lowerOpen?n.MAX_KEY:n.MIN_KEY,e),lowerOpen:!0,upper:Rr(r.upper,r.upperOpen?n.MIN_KEY:n.MAX_KEY,e),upperOpen:!0})}}):t}return i(i({},r),{schema:i(i({},e),{primaryKey:f,indexes:o,getIndexByKeyPath:function(n){var t=u[hr(n)];return t&&t[0]}}),count:function(n){return r.count(h(n))},query:function(n){return r.query(h(n))},openCursor:function(t){var e=t.query.index,i=e.keyTail,u=e.keyLength;return e.isVirtual?r.openCursor(h(t)).then((function(r){return r&&function(r){return Object.create(r,{continue:{value:function(e){null!=e?r.continue(Rr(e,t.reverse?n.MAX_KEY:n.MIN_KEY,i)):t.unique?r.continue(r.key.slice(0,u).concat(t.reverse?n.MIN_KEY:n.MAX_KEY,i)):r.continue()}},continuePrimaryKey:{value:function(t,e){r.continuePrimaryKey(Rr(t,n.MAX_KEY,i),e)}},primaryKey:{get:function(){return r.primaryKey}},key:{get:function(){var n=r.key;return 1===u?n[0]:n.slice(0,u)}},value:{get:function(){return r.value}}})}(r)})):r.openCursor(t)}})}})}};function Mr(n,t,r,e){return r=r||{},e=e||"",a(n).forEach((function(i){if(h(t,i)){var u=n[i],o=t[i];if("object"==typeof u&&"object"==typeof o&&u&&o){var a=K(u);a!==K(o)?r[e+i]=t[i]:"Object"===a?Mr(u,o,r,e+i+"."):u!==o&&(r[e+i]=t[i])}else u!==o&&(r[e+i]=t[i])}else r[e+i]=void 0})),a(t).forEach((function(i){h(n,i)||(r[e+i]=t[i])})),r}var Kr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return i(i({},n),{table:function(t){var r=n.table(t),e=r.schema.primaryKey;return i(i({},r),{mutate:function(n){var o=Bn.trans,a=o.table(t).hook,f=a.deleting,c=a.creating,s=a.updating;switch(n.type){case"add":if(c.fire===an)break;return o._promise("readwrite",(function(){return l(n)}),!0);case"put":if(c.fire===an&&s.fire===an)break;return o._promise("readwrite",(function(){return l(n)}),!0);case"delete":if(f.fire===an)break;return o._promise("readwrite",(function(){return l(n)}),!0);case"deleteRange":if(f.fire===an)break;return o._promise("readwrite",(function(){return function(n){return v(n.trans,n.range,1e4)}(n)}),!0)}return r.mutate(n);function l(n){var t=Bn.trans,o=n.keys||function(n,t){return"delete"===t.type?t.keys:t.keys||t.values.map(n.extractKey)}(e,n);if(!o)throw new Error("Keys missing");return"delete"!==(n="add"===n.type||"put"===n.type?i(i({},n),{keys:o}):i({},n)).type&&(n.values=u([],n.values,!0)),n.keys&&(n.keys=u([],n.keys,!0)),function(n,t,r){return"add"===t.type?Promise.resolve([]):n.getMany({trans:t.trans,keys:r,cache:"immutable"})}(r,n,o).then((function(i){var u=o.map((function(r,u){var o=i[u],a={onerror:null,onsuccess:null};if("delete"===n.type)f.fire.call(a,r,o,t);else if("add"===n.type||void 0===o){var l=c.fire.call(a,r,n.values[u],t);null==r&&null!=l&&(n.keys[u]=r=l,e.outbound||S(n.values[u],e.keyPath,r))}else{var v=Mr(o,n.values[u]),d=s.fire.call(a,v,r,o,t);if(d){var y=n.values[u];Object.keys(d).forEach((function(n){h(y,n)?y[n]=d[n]:S(y,n,d[n])}))}}return a}));return r.mutate(n).then((function(t){for(var r=t.failures,e=t.results,a=t.numFailures,f=t.lastResult,c=0;c<o.length;++c){var s=e?e[c]:o[c],l=u[c];null==s?l.onerror&&l.onerror(r[c]):l.onsuccess&&l.onsuccess("put"===n.type&&i[c]?n.values[c]:s)}return{failures:r,results:e,numFailures:a,lastResult:f}})).catch((function(n){return u.forEach((function(t){return t.onerror&&t.onerror(n)})),Promise.reject(n)}))}))}function v(n,t,u){return r.query({trans:n,values:!1,query:{index:e,range:t},limit:u}).then((function(r){var e=r.result;return l({type:"delete",keys:e,trans:n}).then((function(r){return r.numFailures>0?Promise.reject(r.failures[0]):e.length<u?{failures:[],numFailures:0,lastResult:void 0}:v(n,i(i({},t),{lower:e[e.length-1],lowerOpen:!0}),u)}))}))}}})}})}};function Nr(n,t,r){try{if(!t)return null;if(t.keys.length<n.length)return null;for(var e=[],i=0,u=0;i<t.keys.length&&u<n.length;++i)0===_t(t.keys[i],n[u])&&(e.push(r?R(t.values[i]):t.values[i]),++u);return e.length===n.length?e:null}catch(n){return null}}var qr,Fr={stack:"dbcore",level:-1,create:function(n){return{table:function(t){var r=n.table(t);return i(i({},r),{getMany:function(n){if(!n.cache)return r.getMany(n);var t=Nr(n.keys,n.trans._cache,"clone"===n.cache);return t?qn.resolve(t):r.getMany(n).then((function(t){return n.trans._cache={keys:n.keys,values:"clone"===n.cache?R(t):t},t}))},mutate:function(n){return"add"!==n.type&&(n.trans._cache=null),r.mutate(n)}})}}}};function Ur(n){return!("from"in n)}var _r=function(n,t){if(!this){var r=new _r;return n&&"d"in n&&c(r,n),r}c(this,arguments.length?{d:1,from:n,to:arguments.length>1?t:n}:{d:0})};function Lr(n,t,r){var e=_t(t,r);if(!isNaN(e)){if(e>0)throw RangeError();if(Ur(n))return c(n,{from:t,to:r,d:1});var i=n.l,u=n.r;if(_t(r,n.from)<0)return i?Lr(i,t,r):n.l={from:t,to:r,d:1,l:null,r:null},Wr(n);if(_t(t,n.to)>0)return u?Lr(u,t,r):n.r={from:t,to:r,d:1,l:null,r:null},Wr(n);_t(t,n.from)<0&&(n.from=t,n.l=null,n.d=u?u.d+1:1),_t(r,n.to)>0&&(n.to=r,n.r=null,n.d=n.l?n.l.d+1:1);var o=!n.r;i&&!n.l&&Hr(n,i),u&&o&&Hr(n,u)}}function Hr(n,t){Ur(t)||function n(t,r){var e=r.l,i=r.r;Lr(t,r.from,r.to),e&&n(t,e),i&&n(t,i)}(n,t)}function Vr(n){var t=Ur(n)?null:{s:0,n};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&_t(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||_t(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Wr(n){var t,r,e=((null===(t=n.r)||void 0===t?void 0:t.d)||0)-((null===(r=n.l)||void 0===r?void 0:r.d)||0),u=e>1?"r":e<-1?"l":"";if(u){var o="r"===u?"l":"r",a=i({},n),f=n[u];n.from=f.from,n.to=f.to,n[u]=f[u],a[u]=f[o],n[o]=a,a.d=zr(a)}n.d=zr(n)}function zr(n){var t=n.r,r=n.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}v(_r.prototype,((qr={add:function(n){return Hr(this,n),this},addKey:function(n){return Lr(this,n,n),this},addKeys:function(n){var t=this;return n.forEach((function(n){return Lr(t,n,n)})),this}})[N]=function(){return Vr(this)},qr));var Gr,$r={stack:"dbcore",level:0,create:function(n){var t=n.schema.name,r=new _r(n.MIN_KEY,n.MAX_KEY);return i(i({},n),{table:function(e){var u=n.table(e),o=u.schema,c=o.primaryKey,s=c.extractKey,l=c.outbound,h=i(i({},u),{mutate:function(n){var i=n.trans,a=i.mutatedParts||(i.mutatedParts={}),c=function(n){var r="idb://"+t+"/"+e+"/"+n;return a[r]||(a[r]=new _r)},s=c(""),l=c(":dels"),h=n.type,v="deleteRange"===n.type?[n.range]:"delete"===n.type?[n.keys]:n.values.length<50?[[],n.values]:[],d=v[0],y=v[1],p=n.trans._cache;return u.mutate(n).then((function(n){if(f(d)){"delete"!==h&&(d=n.results),s.addKeys(d);var t=Nr(d,p);t||"add"===h||l.addKeys(d),(t||y)&&function(n,t,r,e){t.indexes.forEach((function(t){var i=n(t.name||"");function u(n){return null!=n?t.extractKey(n):null}var o=function(n){return t.multiEntry&&f(n)?n.forEach((function(n){return i.addKey(n)})):i.addKey(n)};(r||e).forEach((function(n,t){var i=r&&u(r[t]),a=e&&u(e[t]);0!==_t(i,a)&&(null!=i&&o(i),null!=a&&o(a))}))}))}(c,o,t,y)}else if(d){var e={from:d.lower,to:d.upper};l.add(e),s.add(e)}else s.add(r),l.add(r),o.indexes.forEach((function(n){return c(n.name).add(r)}));return n}))}}),v=function(t){var r,e,i=t.query,u=i.range;return[i.index,new _r(null!==(r=u.lower)&&void 0!==r?r:n.MIN_KEY,null!==(e=u.upper)&&void 0!==e?e:n.MAX_KEY)]},d={get:function(n){return[c,new _r(n.key)]},getMany:function(n){return[c,(new _r).addKeys(n.keys)]},count:v,query:v,openCursor:v};return a(d).forEach((function(n){h[n]=function(o){var a=Bn.subscr;if(a){var f=function(n){var r="idb://"+t+"/"+e+"/"+n;return a[r]||(a[r]=new _r)},c=f(""),h=f(":dels"),v=d[n](o),y=v[0],p=v[1];if(f(y.name||"").add(p),!y.isPrimaryKey){if("count"!==n){var w="query"===n&&l&&o.values&&u.query(i(i({},o),{values:!1}));return u[n].apply(this,arguments).then((function(t){if("query"===n){if(l&&o.values)return w.then((function(n){return c.addKeys(n.result),t}));var r=o.values?t.result.map(s):t.result;o.values?c.addKeys(r):h.addKeys(r)}else if("openCursor"===n){var e=t,i=o.values;return e&&Object.create(e,{key:{get:function(){return h.addKey(e.primaryKey),e.key}},primaryKey:{get:function(){var n=e.primaryKey;return h.addKey(n),n}},value:{get:function(){return i&&c.addKey(e.primaryKey),e.value}}})}return t}))}h.add(r)}}return u[n].apply(this,arguments)}})),h}})}},Jr=function(){function n(t,r){var e=this;this._middlewares={},this.verno=0;var u=n.dependencies;this._options=r=i({addons:n.addons,autoOpen:!0,indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var o=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,f={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:an,dbReadyPromise:null,cancelOpen:an,openCanceller:null,autoSchema:!0};f.dbReadyPromise=new qn((function(n){f.dbReadyResolve=n})),f.openCanceller=new qn((function(n,t){f.cancelOpen=t})),this._state=f,this.name=t,this.on=Tt(this,"populate","blocked","versionchange","close",{ready:[yn,an]}),this.on.ready.subscribe=x(this.on.ready.subscribe,(function(t){return function(r,i){n.vip((function(){var n=e._state;if(n.openComplete)n.dbOpenError||qn.resolve().then(r),i&&t(r);else if(n.onReadyBeingFired)n.onReadyBeingFired.push(r),i&&t(r);else{t(r);var u=e;i||t((function n(){u.on.ready.unsubscribe(r),u.on.ready.unsubscribe(n)}))}}))}})),this.Collection=(a=this,Rt(Vt.prototype,(function(n,t){this.db=a;var r=Dt,e=null;if(t)try{r=t()}catch(n){e=n}var i=n._ctx,u=i.table,o=u.hook.reading.fire;this._ctx={table:u,index:i.index,isPrimKey:!i.index||u.schema.primKey.keyPath&&i.index===u.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:e,or:i.or,valueMapper:o!==fn?o:null}}))),this.Table=function(n){return Rt(It.prototype,(function(t,r,e){this.db=n,this._tx=e,this.name=t,this.schema=r,this.hook=n._allTables[t]?n._allTables[t].hook:Tt(null,{creating:[ln,an],reading:[cn,fn],updating:[vn,an],deleting:[hn,an]})}))}(this),this.Transaction=function(n){return Rt(ir.prototype,(function(t,r,e,i,u){var o=this;this.db=n,this.mode=t,this.storeNames=r,this.schema=e,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Tt(this,"complete","error","abort"),this.parent=u||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new qn((function(n,t){o._resolve=n,o._reject=t})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(n){var t=o.active;return o.active=!1,o.on.error.fire(n),o.parent?o.parent._reject(n):t&&o.idbtrans&&o.idbtrans.abort(),gt(n)}))}))}(this),this.Version=function(n){return Rt(Er.prototype,(function(t){this.db=n,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(n){return Rt(nr.prototype,(function(t,r,e){this.db=n,this._ctx={table:t,index:":id"===r?null:r,or:e};var i=n._deps.indexedDB;if(!i)throw new en.MissingAPI;this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(n,t){return i.cmp(t,n)},this._max=function(n,t){return i.cmp(n,t)>0?n:t},this._min=function(n,t){return i.cmp(n,t)<0?n:t},this._IDBKeyRange=n._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(n){n.newVersion>0?console.warn("Another connection wants to upgrade database '"+e.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+e.name+"'. Closing db now to resume the delete request."),e.close()})),this.on("blocked",(function(n){!n.newVersion||n.newVersion<n.oldVersion?console.warn("Dexie.delete('"+e.name+"') was blocked"):console.warn("Upgrade '"+e.name+"' blocked by other connection holding version "+n.oldVersion/10)})),this._maxKey=fr(r.IDBKeyRange),this._createTransaction=function(n,t,r,i){return new e.Transaction(n,t,r,e._options.chromeTransactionDurability,i)},this._fireOnBlocked=function(n){e.on("blocked").fire(n),Et.filter((function(n){return n.name===e.name&&n!==e&&!n._state.vcFired})).map((function(t){return t.on("versionchange").fire(n)}))},this.use(Br),this.use(Kr),this.use($r),this.use(Fr),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach((function(n){return n(e)}))}return n.prototype.version=function(n){if(isNaN(n)||n<.1)throw new en.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new en.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var t=this._versions,r=t.filter((function(t){return t._cfg.version===n}))[0];return r||(r=new this.Version(n),t.push(r),t.sort(wr),r.stores({}),this._state.autoSchema=!1,r)},n.prototype._whenReady=function(n){var t=this;return this.idbdb&&(this._state.openComplete||Bn.letThrough||this._vip)?n():new qn((function(n,r){if(t._state.openComplete)return r(new en.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void r(new en.DatabaseClosed);t.open().catch(an)}t._state.dbReadyPromise.then(n,r)})).then(n)},n.prototype.use=function(n){var t=n.stack,r=n.create,e=n.level,i=n.name;i&&this.unuse({stack:t,name:i});var u=this._middlewares[t]||(this._middlewares[t]=[]);return u.push({stack:t,create:r,level:null==e?10:e,name:i}),u.sort((function(n,t){return n.level-t.level})),this},n.prototype.unuse=function(n){var t=n.stack,r=n.name,e=n.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(n){return e?n.create!==e:!!r&&n.name!==r}))),this},n.prototype.open=function(){return Dr(this)},n.prototype._close=function(){var n=this._state,t=Et.indexOf(this);if(t>=0&&Et.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(n){}this._novip.idbdb=null}n.dbReadyPromise=new qn((function(t){n.dbReadyResolve=t})),n.openCanceller=new qn((function(t,r){n.cancelOpen=r}))},n.prototype.close=function(){this._close();var n=this._state;this._options.autoOpen=!1,n.dbOpenError=new en.DatabaseClosed,n.isBeingOpened&&n.cancelOpen(n.dbOpenError)},n.prototype.delete=function(){var n=this,t=arguments.length>0,r=this._state;return new qn((function(e,i){var u=function(){n.close();var t=n._deps.indexedDB.deleteDatabase(n.name);t.onsuccess=Zn((function(){Sr(n._deps,n.name),e()})),t.onerror=tr(i),t.onblocked=n._fireOnBlocked};if(t)throw new en.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(u):u()}))},n.prototype.backendDB=function(){return this.idbdb},n.prototype.isOpen=function(){return null!==this.idbdb},n.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&"DatabaseClosed"===n.name},n.prototype.hasFailed=function(){return null!==this._state.dbOpenError},n.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(n.prototype,"tables",{get:function(){var n=this;return a(this._allTables).map((function(t){return n._allTables[t]}))},enumerable:!1,configurable:!0}),n.prototype.transaction=function(){var n=Ir.apply(this,arguments);return this._transaction.apply(this,n)},n.prototype._transaction=function(n,t,r){var e=this,i=Bn.trans;i&&i.db===this&&-1===n.indexOf("!")||(i=null);var u,o,a=-1!==n.indexOf("?");n=n.replace("!","").replace("?","");try{if(o=t.map((function(n){var t=n instanceof e.Table?n.name:n;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==n||"readonly"===n)u="readonly";else{if("rw"!=n&&"readwrite"!=n)throw new en.InvalidArgument("Invalid transaction mode: "+n);u="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===u){if(!a)throw new en.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&o.forEach((function(n){if(i&&-1===i.storeNames.indexOf(n)){if(!a)throw new en.SubTransaction("Table "+n+" not included in parent transaction.");i=null}})),a&&i&&!i.active&&(i=null)}}catch(n){return i?i._promise(null,(function(t,r){r(n)})):gt(n)}var f=Tr.bind(null,this,u,o,i,r);return i?i._promise(u,f,"lock"):Bn.trans?dt(Bn.transless,(function(){return e._whenReady(f)})):this._whenReady(f)},n.prototype.table=function(n){if(!h(this._allTables,n))throw new en.InvalidTable("Table "+n+" does not exist");return this._allTables[n]},n}(),Yr="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",Qr=function(){function n(n){this._subscribe=n}return n.prototype.subscribe=function(n,t,r){return this._subscribe(n&&"function"!=typeof n?n:{next:n,error:t,complete:r})},n.prototype[Yr]=function(){return this},n}();function Xr(n,t){return a(t).forEach((function(r){Hr(n[r]||(n[r]=new _r),t[r])})),n}function Zr(n){return new Qr((function(t){var r=_(n),e=!1,i={},u={},o={get closed(){return e},unsubscribe:function(){e=!0,er.storagemutated.unsubscribe(l)}};t.start&&t.start(o);var f=!1,c=!1;function s(){return a(u).some((function(n){return i[n]&&function(n,t){var r=Vr(t),e=r.next();if(e.done)return!1;for(var i=e.value,u=Vr(n),o=u.next(i.from),a=o.value;!e.done&&!o.done;){if(_t(a.from,i.to)<=0&&_t(a.to,i.from)>=0)return!0;_t(i.from,a.from)<0?i=(e=r.next(a.from)).value:a=(o=u.next(i.from)).value}return!1}(i[n],u[n])}))}var l=function(n){Xr(i,n),s()&&h()},h=function(){if(!f&&!e){i={};var a={},v=function(t){r&&at();var e=function(){return ot(n,{subscr:t,trans:null})},i=Bn.trans?dt(Bn.transless,e):e();return r&&i.then(ft,ft),i}(a);c||(er("storagemutated",l),c=!0),f=!0,Promise.resolve(v).then((function(n){f=!1,e||(s()?h():(i={},u=a,t.next&&t.next(n)))}),(function(n){f=!1,t.error&&t.error(n),o.unsubscribe()}))}};return h(),o}))}try{Gr={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch(n){Gr={indexedDB:null,IDBKeyRange:null}}var ne=Jr;function te(n){var t=re;try{re=!0,er.storagemutated.fire(n)}finally{re=t}}v(ne,i(i({},on),{delete:function(n){return new ne(n,{addons:[]}).delete()},exists:function(n){return new ne(n,{addons:[]}).open().then((function(n){return n.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(n){try{return function(n){var t=n.indexedDB,r=n.IDBKeyRange;return jr(t)?Promise.resolve(t.databases()).then((function(n){return n.map((function(n){return n.name})).filter((function(n){return"__dbnames"!==n}))})):Ar(t,r).toCollection().primaryKeys()}(ne.dependencies).then(n)}catch(n){return gt(new en.MissingAPI)}},defineClass:function(){return function(n){c(this,n)}},ignoreTransaction:function(n){return Bn.trans?dt(Bn.transless,n):n()},vip:Pr,async:function(n){return function(){try{var t=Cr(n.apply(this,arguments));return t&&"function"==typeof t.then?t:qn.resolve(t)}catch(n){return gt(n)}}},spawn:function(n,t,r){try{var e=Cr(n.apply(r,t||[]));return e&&"function"==typeof e.then?e:qn.resolve(e)}catch(n){return gt(n)}},currentTransaction:{get:function(){return Bn.trans||null}},waitFor:function(n,t){var r=qn.resolve("function"==typeof n?ne.ignoreTransaction(n):n).timeout(t||6e4);return Bn.trans?Bn.trans.waitFor(r):r},Promise:qn,debug:{get:function(){return L},set:function(n){H(n,"dexie"===n?function(){return!0}:Pt)}},derive:p,extend:c,props:v,override:x,Events:Tt,on:er,liveQuery:Zr,extendObservabilitySet:Xr,getByKeyPath:j,setByKeyPath:S,delByKeyPath:function(n,t){"string"==typeof t?S(n,t,void 0):"length"in t&&[].map.call(t,(function(t){S(n,t,void 0)}))},shallowClone:P,deepClone:R,getObjectDiff:Mr,cmp:_t,asap:E,minKey:-1/0,addons:[],connections:Et,errnames:tn,dependencies:Gr,semVer:"3.2.0",version:"3.2.0".split(".").map((function(n){return parseInt(n)})).reduce((function(n,t,r){return n+t/Math.pow(10,2*r)}))})),ne.maxKey=fr(ne.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(er("storagemutated",(function(n){var t;re||(At?(t=document.createEvent("CustomEvent")).initCustomEvent("x-storagemutated-1",!0,!0,n):t=new CustomEvent("x-storagemutated-1",{detail:n}),re=!0,dispatchEvent(t),re=!1)})),addEventListener("x-storagemutated-1",(function(n){re||te(n.detail)})));var re=!1;if("undefined"!=typeof BroadcastChannel){var ee=new BroadcastChannel("x-storagemutated-1");er("storagemutated",(function(n){re||ee.postMessage(n)})),ee.onmessage=function(n){n.data&&te(n.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){er("storagemutated",(function(n){try{re||("undefined"!=typeof localStorage&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:n})),"object"==typeof self.clients&&u([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach((function(t){return t.postMessage({type:"x-storagemutated-1",changedParts:n})})))}catch(n){}})),addEventListener("storage",(function(n){if("x-storagemutated-1"===n.key){var t=JSON.parse(n.newValue);t&&te(t.changedParts)}}));var ie=self.document&&navigator.serviceWorker;ie&&ie.addEventListener("message",(function(n){var t=n.data;t&&"x-storagemutated-1"===t.type&&te(t.changedParts)}))}function ue(n,t){return n.mapToClass(t),n.upsert=async(t,r)=>{let e=0;return await le(n,t)?e=await n.update(t,r):(await n.add(r,t),e=1),!!e},n}qn.rejectionMapper=function(n,t){if(!n||n instanceof Q||n instanceof TypeError||n instanceof SyntaxError||!n.name||!un[n.name])return n;var r=new un[n.name](t||n.message,n);return"stack"in n&&y(r,"stack",{get:function(){return this.inner.stack}}),r},H(L,Pt);class oe{}class ae{}class fe{}class ce{}class se{}const le=async(n,t)=>!!await n.get(t),he=new class extends Jr{constructor(){super("BigmaManagerDB"),this.selectMaterialToggle=async(n,t)=>this.transaction("rw",this.materials,(async()=>{const r=await this.materials.get(n);if(r){const{isSelected:e,sourceName:i}=r;if(!!e===t)return;const u=null!=t?t:!e||!0;await this.materials.where("[sourceName+isSelected]").equals([i,1]).modify({isSelected:0}),await this.materials.update(n,{isSelected:u?1:0})}})),this.version(5).stores({app:"&key, value",iframes:"&name,isActive,ownerApp,displayMode,detached,size,position,resizable,detachable,closeable",filters:"&name,isActive,ownerApp,displayName,icon",missions:"&id, name,id,data,members",sources:"&name, ownerApp,displayName,schema,isHiddenFromMap,isHiddenFromTimeline",materials:"&id, [sourceName+isSelected], sourceName, isSelected, ownerApp,type,interval,geo,string,drawStyle,additionalProps,visibilityOnMap"}),this._appTable=this.table("app"),this.app=new Proxy({},{get:async(n,t)=>{var r;return null===(r=await this._appTable.get(t))||void 0===r?void 0:r.value},set:async(n,t,r)=>{let e=0;return await(async(n,t)=>await n.where("key").equals(t).count()>0)(this._appTable,t)?e=await this._appTable.update(t,{value:r}):(await this._appTable.add({key:t,value:r}),e=1),!!e||(console.error("can't update unexist property"),!1)},delete:async n=>{try{return await this.table("app").delete(n),!0}catch(n){return console.error(n),!1}}}),ue(this.iframes,oe),ue(this.filters,ae),ue(this.missions,fe),ue(this.sources,se),ue(this.materials,ce)}};console.log(he),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var ve,de=(function(n){n.exports=function(){
/*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   */
var n=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===n.call(t)};function r(n){return"function"==typeof n}function e(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(n,t){return null!=n&&"object"==typeof n&&t in n}var u=RegExp.prototype.test;var o=/\S/;function a(n){return!function(n,t){return u.call(n,t)}(o,n)}var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var c=/\s*/,s=/\s+/,l=/\s*=/,h=/\s*\}/,v=/#|\^|\/|>|\{|&|=|!/;function d(n){this.string=n,this.tail=n,this.pos=0}function y(n,t){this.view=n,this.cache={".":this.view},this.parent=t}function p(){this.templateCache={_cache:{},set:function(n,t){this._cache[n]=t},get:function(n){return this._cache[n]},clear:function(){this._cache={}}}}d.prototype.eos=function(){return""===this.tail},d.prototype.scan=function(n){var t=this.tail.match(n);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},d.prototype.scanUntil=function(n){var t,r=this.tail.search(n);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},y.prototype.push=function(n){return new y(n,this)},y.prototype.lookup=function(n){var t,e,u,o=this.cache;if(o.hasOwnProperty(n))t=o[n];else{for(var a,f,c,s=this,l=!1;s;){if(n.indexOf(".")>0)for(a=s.view,f=n.split("."),c=0;null!=a&&c<f.length;)c===f.length-1&&(l=i(a,f[c])||(u=f[c],null!=(e=a)&&"object"!=typeof e&&e.hasOwnProperty&&e.hasOwnProperty(u))),a=a[f[c++]];else a=s.view[n],l=i(s.view,n);if(l){t=a;break}s=s.parent}o[n]=t}return r(t)&&(t=t.call(this.view)),t},p.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},p.prototype.parse=function(n,r){var i=this.templateCache,u=n+":"+(r||w.tags).join(":"),o=void 0!==i,f=o?i.get(u):void 0;return null==f&&(f=function(n,r){if(!n)return[];var i,u,o,f=!1,y=[],p=[],m=[],g=!1,b=!1,x="",k=0;function E(){if(g&&!b)for(;m.length;)delete p[m.pop()];else m=[];g=!1,b=!1}function A(n){if("string"==typeof n&&(n=n.split(s,2)),!t(n)||2!==n.length)throw new Error("Invalid tags: "+n);i=new RegExp(e(n[0])+"\\s*"),u=new RegExp("\\s*"+e(n[1])),o=new RegExp("\\s*"+e("}"+n[1]))}A(r||w.tags);for(var j,S,P,O,D,C,I=new d(n);!I.eos();){if(j=I.pos,P=I.scanUntil(i))for(var T=0,R=P.length;T<R;++T)a(O=P.charAt(T))?(m.push(p.length),x+=O):(b=!0,f=!0,x+=" "),p.push(["text",O,j,j+1]),j+=1,"\n"===O&&(E(),x="",k=0,f=!1);if(!I.scan(i))break;if(g=!0,S=I.scan(v)||"name",I.scan(c),"="===S?(P=I.scanUntil(l),I.scan(l),I.scanUntil(u)):"{"===S?(P=I.scanUntil(o),I.scan(h),I.scanUntil(u),S="&"):P=I.scanUntil(u),!I.scan(u))throw new Error("Unclosed tag at "+I.pos);if(D=">"==S?[S,P,j,I.pos,x,k,f]:[S,P,j,I.pos],k++,p.push(D),"#"===S||"^"===S)y.push(D);else if("/"===S){if(!(C=y.pop()))throw new Error('Unopened section "'+P+'" at '+j);if(C[1]!==P)throw new Error('Unclosed section "'+C[1]+'" at '+j)}else"name"===S||"{"===S||"&"===S?b=!0:"="===S&&A(P)}if(E(),C=y.pop())throw new Error('Unclosed section "'+C[1]+'" at '+I.pos);return function(n){for(var t,r=[],e=r,i=[],u=0,o=n.length;u<o;++u)switch((t=n[u])[0]){case"#":case"^":e.push(t),i.push(t),e=t[4]=[];break;case"/":i.pop()[5]=t[2],e=i.length>0?i[i.length-1][4]:r;break;default:e.push(t)}return r}(function(n){for(var t,r,e=[],i=0,u=n.length;i<u;++i)(t=n[i])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(e.push(t),r=t));return e}(p))}(n,r),o&&i.set(u,f)),f},p.prototype.render=function(n,t,r,e){var i=this.getConfigTags(e),u=this.parse(n,i),o=t instanceof y?t:new y(t,void 0);return this.renderTokens(u,o,r,n,e)},p.prototype.renderTokens=function(n,t,r,e,i){for(var u,o,a,f="",c=0,s=n.length;c<s;++c)a=void 0,"#"===(o=(u=n[c])[0])?a=this.renderSection(u,t,r,e,i):"^"===o?a=this.renderInverted(u,t,r,e,i):">"===o?a=this.renderPartial(u,t,r,i):"&"===o?a=this.unescapedValue(u,t):"name"===o?a=this.escapedValue(u,t,i):"text"===o&&(a=this.rawValue(u)),void 0!==a&&(f+=a);return f},p.prototype.renderSection=function(n,e,i,u,o){var a=this,f="",c=e.lookup(n[1]);if(c){if(t(c))for(var s=0,l=c.length;s<l;++s)f+=this.renderTokens(n[4],e.push(c[s]),i,u,o);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)f+=this.renderTokens(n[4],e.push(c),i,u,o);else if(r(c)){if("string"!=typeof u)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(e.view,u.slice(n[3],n[5]),(function(n){return a.render(n,e,i,o)})))&&(f+=c)}else f+=this.renderTokens(n[4],e,i,u,o);return f}},p.prototype.renderInverted=function(n,r,e,i,u){var o=r.lookup(n[1]);if(!o||t(o)&&0===o.length)return this.renderTokens(n[4],r,e,i,u)},p.prototype.indentPartial=function(n,t,r){for(var e=t.replace(/[^ \t]/g,""),i=n.split("\n"),u=0;u<i.length;u++)i[u].length&&(u>0||!r)&&(i[u]=e+i[u]);return i.join("\n")},p.prototype.renderPartial=function(n,t,e,i){if(e){var u=this.getConfigTags(i),o=r(e)?e(n[1]):e[n[1]];if(null!=o){var a=n[4],f=o;0==n[5]&&a&&(f=this.indentPartial(o,a,n[6]));var c=this.parse(f,u);return this.renderTokens(c,t,e,f,i)}}},p.prototype.unescapedValue=function(n,t){var r=t.lookup(n[1]);if(null!=r)return r},p.prototype.escapedValue=function(n,t,r){var e=this.getConfigEscape(r)||w.escape,i=t.lookup(n[1]);if(null!=i)return"number"==typeof i&&e===w.escape?String(i):e(i)},p.prototype.rawValue=function(n){return n[1]},p.prototype.getConfigTags=function(n){return t(n)?n:n&&"object"==typeof n?n.tags:void 0},p.prototype.getConfigEscape=function(n){return n&&"object"==typeof n&&!t(n)?n.escape:void 0};var w={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(n){m.templateCache=n},get templateCache(){return m.templateCache}},m=new p;return w.clearCache=function(){return m.clearCache()},w.parse=function(n,t){return m.parse(n,t)},w.render=function(n,r,e,i){if("string"!=typeof n)throw new TypeError('Invalid template! Template should be a "string" but "'+((t(u=n)?"array":typeof u)+'" was given as the first argument for mustache#render(template, view, partials)'));var u;return m.render(n,r,e,i)},w.escape=function(n){return String(n).replace(/[&<>"'`=\/]/g,(function(n){return f[n]}))},w.Scanner=d,w.Context=y,w.Writer=p,w}()}(ve={path:undefined,exports:{},require:function(){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}}),ve.exports);const ye=he;console.log("UiList file Loaded");let pe=class{constructor(r){if(n(this,r),this.showDetails=t(this,"showDetails",7),this.materials=[],this.subscribers=[],this.itemTemplate="{{id}}",this.selectHandler=n=>{ye.selectMaterialToggle(n.id)},this.onDelete=n=>{he.materials.delete(n)},this.showDetailsHandler=n=>{this.showDetails.emit(n)},console.log("UiList component Loaded"),!this.sourceName)return;const e=this.elm.querySelector('[slot="item-template"]');e&&(this.itemTemplate=this._getTemplateHtmlAsString(e)),this.subscribers.push(Zr((()=>he.materials.where("sourceName").equals(this.sourceName).toArray())).subscribe((n=>{this.materials=n}))),this.subscribers.push(Zr((async()=>{var n;return null===(n=await he.materials.where("[sourceName+isSelected]").equals([this.sourceName,1]).first())||void 0===n?void 0:n.id})).subscribe((n=>{this.selected=n})))}scrollToSelected(n){var t;if(!n)return;const r=this.elm.querySelector("#"+this._buildId(n));console.log(r,"**el**"),null===(t=null==r?void 0:r.scrollIntoView)||void 0===t||t.call(r,{behavior:"smooth",block:"center"})}disconnectedCallback(){var n;null===(n=this.subscribers)||void 0===n||n.forEach((n=>{var t;return null===(t=null==n?void 0:n.unsubscribe)||void 0===t?void 0:t.call(n)}))}_getTemplateHtmlAsString(n){return Array.from(n.children).map((n=>n.outerHTML)).join("")}_buildId(n){return`item-${n}`}render(){var n;const t=null===(n=this.materials)||void 0===n?void 0:n.map((n=>{const t=de.render(this.itemTemplate,n);return r("div",{id:this._buildId(n.id),onClick:()=>this.selectHandler(n),class:"item-child material-item "+(n.isSelected?"selected":"")},r("div",{class:"custom-content",innerHTML:t}),r("div",{class:"actions"},r("div",{class:"btns"},r("button",{onClick:()=>this.showDetailsHandler(n),class:"details"},"Details"),r("button",{onClick:()=>{this.onDelete(n.id)},class:"delete"},"Delete"))))}));return r("div",{class:"list-con"},t)}get elm(){return e(this)}static get watchers(){return{selected:["scrollToSelected"]}}};pe.style=":host{display:block}.material-item{display:flex;justify-content:space-between;padding:0.5em;border-bottom:1px solid gray}.material-item.selected{background-color:rgba(0, 255, 255, 0.561)}.material-item.selected button.delete{background-color:#c02d2d}.material-item.selected button.details{background-color:#57c02d}.material-item .btns{display:flex;gap:0.3em}.material-item button{background-color:transparent;border:1px solid transparent;color:#eee;cursor:pointer;border-radius:2px;transition:all 0.3s ease}.material-item button:hover{background-color:#c02d2d}.material-item button.details:hover{background-color:rgba(86, 200, 40, 0.774)}";export{pe as ui_list}