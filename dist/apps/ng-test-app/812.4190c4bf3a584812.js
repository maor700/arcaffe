"use strict";(self.webpackChunkng_test_app=self.webpackChunkng_test_app||[]).push([[812],{812:(ya,Pn,lt)=>{lt.r(Pn),lt.d(Pn,{ui_list:()=>Sr});var se=lt(553),ce=lt(29),N=function(){return N=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++)for(var a in n=arguments[r])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},N.apply(this,arguments)};function Ft(t,e,n){if(n||2===arguments.length)for(var a,r=0,i=e.length;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}var V="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Y=Object.keys,X=Array.isArray;function Z(t,e){return"object"!=typeof e||Y(e).forEach(function(n){t[n]=e[n]}),t}"undefined"!=typeof Promise&&!V.Promise&&(V.Promise=Promise);var Ve=Object.getPrototypeOf,Ar={}.hasOwnProperty;function re(t,e){return Ar.call(t,e)}function Re(t,e){"function"==typeof e&&(e=e(Ve(t))),("undefined"==typeof Reflect?Y:Reflect.ownKeys)(e).forEach(function(n){le(t,n,e[n])})}var Rn=Object.defineProperty;function le(t,e,n,r){Rn(t,e,Z(n&&re(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Oe(t){return{from:function(e){return t.prototype=Object.create(e.prototype),le(t.prototype,"constructor",t),{extend:Re.bind(null,t.prototype)}}}}var Cr=Object.getOwnPropertyDescriptor;function jt(t,e){var r;return Cr(t,e)||(r=Ve(t))&&jt(r,e)}var Tr=[].slice;function ft(t,e,n){return Tr.call(t,e,n)}function On(t,e){return e(t)}function We(t){if(!t)throw new Error("Assertion Failed")}function Bn(t){V.setImmediate?setImmediate(t):setTimeout(t,0)}function Mn(t,e){return t.reduce(function(n,r,i){var a=e(r,i);return a&&(n[a[0]]=a[1]),n},{})}function fe(t,e){if(re(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var n=[],r=0,i=e.length;r<i;++r){var a=fe(t,e[r]);n.push(a)}return n}var u=e.indexOf(".");if(-1!==u){var o=t[e.substr(0,u)];return void 0===o?void 0:fe(o,e.substr(u+1))}}function ae(t,e,n){if(t&&void 0!==e&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){We("string"!=typeof n&&"length"in n);for(var r=0,i=e.length;r<i;++r)ae(t,e[r],n[r])}else{var a=e.indexOf(".");if(-1!==a){var u=e.substr(0,a),o=e.substr(a+1);if(""===o)void 0===n?X(t)&&!isNaN(parseInt(u))?t.splice(u,1):delete t[u]:t[u]=n;else{var s=t[u];s||(s=t[u]={}),ae(s,o,n)}}else void 0===n?X(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Fn(t){var e={};for(var n in t)re(t,n)&&(e[n]=t[n]);return e}var Dr=[].concat;function jn(t){return Dr.apply([],t)}var Nn="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(jn([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return V[t]}),Ir=Nn.map(function(t){return V[t]});Mn(Nn,function(t){return[t,!0]});var ge=null;function ze(t){ge="undefined"!=typeof WeakMap&&new WeakMap;var e=Nt(t);return ge=null,e}function Nt(t){if(!t||"object"!=typeof t)return t;var e=ge&&ge.get(t);if(e)return e;if(X(t)){e=[],ge&&ge.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Nt(t[n]))}else if(Ir.indexOf(t.constructor)>=0)e=t;else{var i=Ve(t);for(var a in e=i===Object.prototype?{}:Object.create(i),ge&&ge.set(t,e),t)re(t,a)&&(e[a]=Nt(t[a]))}return e}var Pr={}.toString;function Lt(t){return Pr.call(t).slice(8,-1)}var Ut="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",Rr="symbol"==typeof Ut?function(t){var e;return null!=t&&(e=t[Ut])&&e.apply(t)}:function(){return null},Be={};function he(t){var e,n,r,i;if(1===arguments.length){if(X(t))return t.slice();if(this===Be&&"string"==typeof t)return[t];if(i=Rr(t)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==t)return[t];if("number"==typeof(e=t.length)){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var Ht="undefined"!=typeof Symbol?function(t){return"AsyncFunction"===t[Symbol.toStringTag]}:function(){return!1},ue="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ln(t,e){ue=t,Un=e}var Un=function(){return!0},Or=!new Error("").stack;function Me(){if(Or)try{throw new Error}catch(t){return t}return new Error}function Vt(t,e){var n=t.stack;return n?(e=e||0,0===n.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),n.split("\n").slice(e).filter(Un).map(function(r){return"\n"+r}).join("")):""}var Hn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Wt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Hn),Mr={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Fe(t,e){this._e=Me(),this.name=t,this.message=e}function Vn(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join("\n")}function ht(t,e,n,r){this._e=Me(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Vn(t,e)}function Ye(t,e){this._e=Me(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=Vn(t,e)}Oe(Fe).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Vt(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Oe(ht).from(Fe),Oe(Ye).from(Fe);var Fr=Wt.reduce(function(t,e){return t[e]=e+"Error",t},{}),jr=Fe,M=Wt.reduce(function(t,e){var n=e+"Error";function r(i,a){this._e=Me(),this.name=n,i?"string"==typeof i?(this.message=i+(a?"\n "+a:""),this.inner=a||null):"object"==typeof i&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Mr[e]||n,this.inner=null)}return Oe(r).from(jr),t[e]=r,t},{});M.Syntax=SyntaxError,M.Type=TypeError,M.Range=RangeError;var Wn=Hn.reduce(function(t,e){return t[e+"Error"]=M[e],t},{}),dt=Wt.reduce(function(t,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=M[e]),t},{});function U(){}function Ge(t){return t}function Lr(t,e){return null==t||t===Ge?e:function(n){return e(t(n))}}function Ae(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Ur(t,e){return t===U?e:function(){var n=t.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ae(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ae(i,this.onerror):i),void 0!==a?a:n}}function Hr(t,e){return t===U?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ae(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ae(r,this.onerror):r)}}function Vr(t,e){return t===U?e:function(n){var r=t.apply(this,arguments);Z(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var u=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ae(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Ae(a,this.onerror):a),void 0===r?void 0===u?void 0:u:Z(r,u)}}function Wr(t,e){return t===U?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function zt(t,e){return t===U?e:function(){var n=t.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return e.apply(r,a)})}return e.apply(this,arguments)}}dt.ModifyError=ht,dt.DexieError=Fe,dt.BulkError=Ye;var qe={},Yt="undefined"==typeof Promise?[]:function(){var t=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[t,Ve(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Ve(e),t]}(),Gt=Yt[0],pt=Yt[1],qt=Yt[2],Yn=pt&&pt.then,vt=Gt&&Gt.constructor,Qt=!!qt,Xt=!1,Gr=qt?function(){qt.then(bt)}:V.setImmediate?setImmediate.bind(null,bt):V.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){bt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(bt,0)},Qe=function(t,e){Xe.push([t,e]),yt&&(Gr(),yt=!1)},$t=!0,yt=!0,Ce=[],mt=[],Zt=null,Jt=Ge,je={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:nr,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{nr(t[0],t[1])}catch(e){}})}},O=je,Xe=[],Te=0,gt=[];function k(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=U,this._lib=!1;var e=this._PSD=O;if(ue&&(this._stackHolder=Me(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==qe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&tn(this,this._value))}this._state=null,this._value=null,++e.ref,qn(this,t)}var en={get:function(){var t=O,e=Et;function n(r,i){var a=this,u=!t.global&&(t!==O||e!==Et),o=u&&!de(),s=new k(function(c,f){nn(a,new Gn(St(r,t,u,o),St(i,t,u,o),c,f,t))});return ue&&$n(s,this),s}return n.prototype=qe,n},set:function(t){le(this,"then",t&&t.prototype===qe?en:{get:function(){return t},set:en.set})}};function Gn(t,e,n,r,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=r,this.psd=i}function qn(t,e){try{e(function(n){if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&$e();n&&"function"==typeof n.then?qn(t,function(i,a){n instanceof k?n._then(i,a):n.then(i,a)}):(t._state=!0,t._value=n,Qn(t)),r&&Ze()}},tn.bind(null,t))}catch(n){tn(t,n)}}function tn(t,e){if(mt.push(e),null===t._state){var n=t._lib&&$e();e=Jt(e),t._state=!1,t._value=e,ue&&null!==e&&"object"==typeof e&&!e._promise&&function(t,e,n){try{t.apply(null,void 0)}catch(r){}}(function(){var r=jt(e,"stack");e._promise=t,le(e,"stack",{get:function(){return Xt?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),function(t){Ce.some(function(e){return e._value===t._value})||Ce.push(t)}(t),Qn(t),n&&Ze()}}function Qn(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)nn(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),0===Te&&(++Te,Qe(function(){0==--Te&&rn()},[]))}function nn(t,e){if(null!==t._state){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Te,Qe(qr,[n,t,e])}else t._listeners.push(e)}function qr(t,e,n){try{Zt=e;var r,i=e._value;e._state?r=t(i):(mt.length&&(mt=[]),r=t(i),-1===mt.indexOf(i)&&function(t){for(var e=Ce.length;e;)if(Ce[--e]._value===t._value)return void Ce.splice(e,1)}(e)),n.resolve(r)}catch(a){n.reject(a)}finally{Zt=null,0==--Te&&rn(),--n.psd.ref||n.psd.finalize()}}function Xn(t,e,n){if(e.length===n)return e;var r="";if(!1===t._state){var a,u,i=t._value;null!=i?(a=i.name||"Error",u=i.message||i,r=Vt(i,0)):(a=i,u=""),e.push(a+(u?": "+u:"")+r)}return ue&&((r=Vt(t._stackHolder,2))&&-1===e.indexOf(r)&&e.push(r),t._prev&&Xn(t._prev,e,n)),e}function $n(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function bt(){$e()&&Ze()}function $e(){var t=$t;return $t=!1,yt=!1,t}function Ze(){var t,e,n;do{for(;Xe.length>0;)for(t=Xe,Xe=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}}while(Xe.length>0);$t=!0,yt=!0}function rn(){var t=Ce;Ce=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=gt.slice(0),n=e.length;n;)e[--n]()}function _t(t){return new k(qe,!1,t)}function z(t,e){var n=O;return function(){var r=$e(),i=O;try{return _e(n,!0),t.apply(this,arguments)}catch(a){e&&e(a)}finally{_e(i,!1),r&&Ze()}}}Re(k.prototype,{then:en,_then:function(t,e){nn(this,new Gn(null,null,t,e,O))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=arguments[0],n=arguments[1];return this.then(null,"function"==typeof e?function(r){return r instanceof e?n(r):_t(r)}:function(r){return r&&r.name===e?n(r):_t(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),_t(e)})},stack:{get:function(){if(this._stack)return this._stack;try{Xt=!0;var e=Xn(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Xt=!1}}},timeout:function(t,e){var n=this;return t<1/0?new k(function(r,i){var a=setTimeout(function(){return i(new M.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&le(k.prototype,Symbol.toStringTag,"Dexie.Promise"),je.env=Zn(),Re(k,{all:function(){var t=he.apply(null,arguments).map(xt);return new k(function(e,n){0===t.length&&e([]);var r=t.length;t.forEach(function(i,a){return k.resolve(i).then(function(u){t[a]=u,--r||e(t)},n)})})},resolve:function(t){if(t instanceof k)return t;if(t&&"function"==typeof t.then)return new k(function(n,r){t.then(n,r)});var e=new k(qe,!0,t);return $n(e,Zt),e},reject:_t,race:function(){var t=he.apply(null,arguments).map(xt);return new k(function(e,n){t.map(function(r){return k.resolve(r).then(e,n)})})},PSD:{get:function(){return O},set:function(t){return O=t}},totalEchoes:{get:function(){return Et}},newPSD:be,usePSD:Le,scheduler:{get:function(){return Qe},set:function(t){Qe=t}},rejectionMapper:{get:function(){return Jt},set:function(t){Jt=t}},follow:function(t,e){return new k(function(n,r){return be(function(i,a){var u=O;u.unhandleds=[],u.onunhandled=a,u.finalize=Ae(function(){var o=this;gt.push(function e(){0===o.unhandleds.length?i():a(o.unhandleds[0]),gt.splice(gt.indexOf(e),1)}),++Te,Qe(function(){0==--Te&&rn()},[])},u.finalize),t()},e,n,r)})}}),vt&&(vt.allSettled&&le(k,"allSettled",function(){var t=he.apply(null,arguments).map(xt);return new k(function(e){0===t.length&&e([]);var n=t.length,r=new Array(n);t.forEach(function(i,a){return k.resolve(i).then(function(u){return r[a]={status:"fulfilled",value:u}},function(u){return r[a]={status:"rejected",reason:u}}).then(function(){return--n||e(r)})})})}),vt.any&&"undefined"!=typeof AggregateError&&le(k,"any",function(){var t=he.apply(null,arguments).map(xt);return new k(function(e,n){0===t.length&&n(new AggregateError([]));var r=t.length,i=new Array(r);t.forEach(function(a,u){return k.resolve(a).then(function(o){return e(o)},function(o){i[u]=o,--r||n(new AggregateError(i))})})})}));var $={awaits:0,echoes:0,id:0},Zr=0,wt=[],an=0,Et=0,Jr=0;function be(t,e,n,r){var i=O,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++Jr;var u=je.env;a.env=Qt?{Promise:k,PromiseProp:{value:k,configurable:!0,writable:!0},all:k.all,race:k.race,allSettled:k.allSettled,any:k.any,resolve:k.resolve,reject:k.reject,nthen:er(u.nthen,a),gthen:er(u.gthen,a)}:{},e&&Z(a,e),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Le(a,t,n,r);return 0===a.ref&&a.finalize(),o}function Ne(){return $.id||($.id=++Zr),++$.awaits,$.echoes+=100,$.id}function de(){return!!$.awaits&&(0==--$.awaits&&($.id=0),$.echoes=100*$.awaits,!0)}function xt(t){return $.echoes&&t&&t.constructor===vt?(Ne(),t.then(function(e){return de(),e},function(e){return de(),q(e)})):t}function ei(t){++Et,(!$.echoes||0==--$.echoes)&&($.echoes=$.id=0),wt.push(O),_e(t,!0)}function ti(){var t=wt[wt.length-1];wt.pop(),_e(t,!1)}function _e(t,e){var n=O;if((e?$.echoes&&(!an++||t!==O):an&&(!--an||t!==O))&&Jn(e?ei.bind(null,t):ti),t!==O&&(O=t,n===je&&(je.env=Zn()),Qt)){var r=je.env.Promise,i=t.env;pt.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(V,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Zn(){var t=V.Promise;return Qt?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(V,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:pt.then,gthen:t.prototype.then}:{}}function Le(t,e,n,r,i){var a=O;try{return _e(t,!0),e(n,r,i)}finally{_e(a,!1)}}function Jn(t){Yn.call(Gt,t)}function St(t,e,n,r){return"function"!=typeof t?t:function(){var i=O;n&&Ne(),_e(e,!0);try{return t.apply(this,arguments)}finally{_e(i,!1),r&&Jn(de)}}}function er(t,e){return function(n,r){return t.call(this,St(n,e),St(r,e))}}-1===(""+Yn).indexOf("[native code]")&&(Ne=de=U);var tr="unhandledrejection";function nr(t,e){var n;try{n=e.onuncatched(t)}catch(a){}if(!1!==n)try{var r,i={promise:e,reason:t};if(V.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(tr,!0,!0),Z(r,i)):V.CustomEvent&&Z(r=new CustomEvent(tr,{detail:i}),i),r&&V.dispatchEvent&&(dispatchEvent(r),!V.PromiseRejectionEvent&&V.onunhandledrejection))try{V.onunhandledrejection(r)}catch(a){}ue&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch(a){}}var q=k.reject;function rr(t,e,n,r){if(t.idbdb&&(t._state.openComplete||O.letThrough||t._vip)){var i=t._createTransaction(e,n,t._dbSchema);try{i.create()}catch(a){return q(a)}return i._promise(e,function(a,u){return be(function(){return O.trans=i,r(a,u,i)})}).then(function(a){return i._completion.then(function(){return a})})}if(t._state.openComplete)return q(new M.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return q(new M.DatabaseClosed);t.open().catch(U)}return t._state.dbReadyPromise.then(function(){return rr(t,e,n,r)})}var ke=String.fromCharCode(65535),un=-1/0,pe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ar="String expected.",Je=[],At="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ni=At,ri=At,ur=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},Ct="__dbnames",on="readonly",sn="readwrite";function Ke(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var or={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Tt(t){return"string"!=typeof t||/\./.test(t)?function(e){return e}:function(e){return void 0===e[t]&&t in e&&delete(e=ze(e))[t],e}}var ii=function(){function t(){}return t.prototype._trans=function(e,n,r){var i=this._tx||O.trans,a=this.name;function u(s,c,f){if(!f.schema[a])throw new M.NotFound("Table "+a+" not part of transaction");return n(f.idbtrans,f)}var o=$e();try{return i&&i.db===this.db?i===O.trans?i._promise(e,u,r):be(function(){return i._promise(e,u,r)},{trans:i,transless:O.transless||O}):rr(this.db,e,[this.name],u)}finally{o&&Ze()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},t.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(X(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=Y(e);if(1===n.length)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(f){return f.compound&&n.every(function(l){return f.keyPath.indexOf(l)>=0})&&f.keyPath.every(function(l){return n.indexOf(l)>=0})})[0];if(r&&this.db._maxKey!==ke)return this.where(r.name).equals(r.keyPath.map(function(f){return e[f]}));!r&&ue&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+n.join("+")+"]");var i=this.schema.idxByName,a=this.db._deps.indexedDB;function u(f,l){try{return 0===a.cmp(f,l)}catch(p){return!1}}var o=n.reduce(function(f,l){var p=f[0],E=f[1],v=i[l],d=e[l];return[p||v,p||!v?Ke(E,v&&v.multi?function(g){var x=fe(g,l);return X(x)&&x.some(function(A){return u(d,A)})}:function(g){return u(d,fe(g,l))}):E]},[null,null]),s=o[0],c=o[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(c):r?this.filter(c):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,X(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var i=Object.create(e.prototype);for(var a in r)if(re(r,a))try{i[a]=r[a]}catch(u){}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){return this.mapToClass(function(n){Z(this,n)})},t.prototype.add=function(e,n){var r=this,i=this.schema.primKey,u=i.keyPath,o=e;return u&&i.auto&&(o=Tt(u)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:null!=n?[n]:null,values:[o]})}).then(function(s){return s.numFailures?k.reject(s.failures[0]):s.lastResult}).then(function(s){if(u)try{ae(e,u,s)}catch(c){}return s})},t.prototype.update=function(e,n){if("object"!=typeof e||X(e))return this.where(":id").equals(e).modify(n);var r=fe(e,this.schema.primKey.keyPath);if(void 0===r)return q(new M.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof n?Y(n).forEach(function(i){ae(e,i,n[i])}):n(e,{value:e,primKey:r})}catch(i){}return this.where(":id").equals(r).modify(n)},t.prototype.put=function(e,n){var r=this,i=this.schema.primKey,u=i.keyPath,o=e;return u&&i.auto&&(o=Tt(u)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[o],keys:null!=n?[n]:null})}).then(function(s){return s.numFailures?k.reject(s.failures[0]):s.lastResult}).then(function(s){if(u)try{ae(e,u,s)}catch(c){}return s})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?k.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:or})}).then(function(n){return n.numFailures?k.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},t.prototype.bulkAdd=function(e,n,r){var i=this,a=Array.isArray(n)?n:void 0,u=(r=r||(a?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",function(o){var s=i.schema.primKey,c=s.auto,f=s.keyPath;if(f&&a)throw new M.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new M.InvalidArgument("Arguments objects and keys must have the same length");var l=e.length,p=f&&c?e.map(Tt(f)):e;return i.core.mutate({trans:o,type:"add",keys:a,values:p,wantResults:u}).then(function(E){var v=E.numFailures;if(0===v)return u?E.results:E.lastResult;throw new Ye(i.name+".bulkAdd(): "+v+" of "+l+" operations failed",E.failures)})})},t.prototype.bulkPut=function(e,n,r){var i=this,a=Array.isArray(n)?n:void 0,u=(r=r||(a?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",function(o){var s=i.schema.primKey,c=s.auto,f=s.keyPath;if(f&&a)throw new M.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new M.InvalidArgument("Arguments objects and keys must have the same length");var l=e.length,p=f&&c?e.map(Tt(f)):e;return i.core.mutate({trans:o,type:"put",keys:a,values:p,wantResults:u}).then(function(E){var v=E.numFailures;if(0===v)return u?E.results:E.lastResult;throw new Ye(i.name+".bulkPut(): "+v+" of "+l+" operations failed",E.failures)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var a=i.numFailures;if(0===a)return i.lastResult;throw new Ye(n.name+".bulkDelete(): "+a+" of "+r+" operations failed",i.failures)})},t}();function et(t){var e={},n=function(o,s){if(s){for(var c=arguments.length,f=new Array(c-1);--c;)f[c-1]=arguments[c];return e[o].subscribe.apply(null,f),t}if("string"==typeof o)return e[o]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(o,s,c){if("object"==typeof o)return u(o);s||(s=Wr),c||(c=U);var f={subscribers:[],fire:c,subscribe:function(l){-1===f.subscribers.indexOf(l)&&(f.subscribers.push(l),f.fire=s(f.fire,l))},unsubscribe:function(l){f.subscribers=f.subscribers.filter(function(p){return p!==l}),f.fire=f.subscribers.reduce(s,c)}};return e[o]=n[o]=f,f}function u(o){Y(o).forEach(function(s){var c=o[s];if(X(c))a(s,o[s][0],o[s][1]);else{if("asap"!==c)throw new M.InvalidArgument("Invalid event config");var f=a(s,Ge,function(){for(var p=arguments.length,E=new Array(p);p--;)E[p]=arguments[p];f.subscribers.forEach(function(v){Bn(function(){v.apply(null,E)})})})}})}}function tt(t,e){return Oe(e).from({prototype:t}),e}function Ue(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function cn(t,e){t.filter=Ke(t.filter,e)}function ln(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Ke(r(),e())}:e,t.justLimit=n&&!r}function kt(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new M.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function sr(t,e,n){var r=kt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:"prev"===t.dir,unique:!!t.unique,query:{index:r,range:t.range}})}function Kt(t,e,n,r){var i=t.replayFilter?Ke(t.filter,t.replayFilter()):t.filter;if(t.or){var a={},u=function(o,s,c){if(!i||i(s,c,function(p){return s.stop(p)},function(p){return s.fail(p)})){var f=s.primaryKey,l=""+f;"[object ArrayBuffer]"===l&&(l=""+new Uint8Array(f)),re(a,l)||(a[l]=!0,e(o,s,c))}};return Promise.all([t.or._iterate(u,n),cr(sr(t,r,n),t.algorithm,u,!t.keysOnly&&t.valueMapper)])}return cr(sr(t,r,n),Ke(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function cr(t,e,n,r){var a=z(r?function(u,o,s){return n(r(u),o,s)}:n);return t.then(function(u){if(u)return u.start(function(){var o=function(){return u.continue()};(!e||e(u,function(s){return o=s},function(s){u.stop(s),o=U},function(s){u.fail(s),o=U}))&&a(u.value,u,function(s){return o=s}),o()})})}function J(t,e){try{var n=lr(t),r=lr(e);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,a=0;a<i;++a)if(t[a]!==e[a])return t[a]<e[a]?-1:1;return n===r?0:n<r?-1:1}(fr(t),fr(e));case"Array":return function(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,a=0;a<i;++a){var u=J(t[a],e[a]);if(0!==u)return u}return n===r?0:n<r?-1:1}(t,e)}}catch(i){}return NaN}function lr(t){var e=typeof t;if("object"!==e)return e;if(ArrayBuffer.isView(t))return"binary";var n=Lt(t);return"ArrayBuffer"===n?"binary":n}function fr(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var ci=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,q.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,q.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Ke(n.algorithm,e)},t.prototype._iterate=function(e,n){return Kt(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Z(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return Kt(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(Ue(i,!0))return a.count({trans:r,query:{index:kt(i,a.schema),range:i.range}}).then(function(o){return Math.min(o,i.limit)});var u=0;return Kt(i,function(){return++u,!1},r,a).then(function(){return u})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),i=r[0],a=r.length-1;function u(c,f){return f?u(c[r[f]],f-1):c[i]}var o="next"===this._ctx.dir?1:-1;function s(c,f){var l=u(c,a),p=u(f,a);return l<p?-o:l>p?o:0}return this.toArray(function(c){return c.sort(s)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var i=n._ctx;if("next"===i.dir&&Ue(i,!0)&&i.limit>0){var a=i.valueMapper,u=kt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:u,range:i.range}}).then(function(s){var c=s.result;return a?c.map(a):c})}var o=[];return Kt(i,function(s){return o.push(s)},r,i.table.core).then(function(){return o})},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0||(n.offset+=e,Ue(n)?ln(n,function(){var r=e;return function(i,a){return 0===r||(1===r?(--r,!1):(a(function(){i.advance(r),r=0}),!1))}}):ln(n,function(){var r=e;return function(){return--r<0}})),this},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),ln(this._ctx,function(){var n=e;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},t.prototype.until=function(e,n){return cn(this._ctx,function(r,i,a){return!e(r.value)||(i(a),n)}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return cn(this._ctx,function(n){return e(n.value)}),function(t,e){t.isMatch=Ke(t.isMatch,e)}(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if("next"===n.dir&&Ue(n,!0)&&n.limit>0)return this._read(function(i){var a=kt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){return i.result}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return cn(this._ctx,function(i){var a=i.primaryKey.toString(),u=re(r,a);return r[a]=!0,!u}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(i){var a;if("function"==typeof e)a=e;else{var u=Y(e),o=u.length;a=function(x){for(var A=!1,_=0;_<o;++_){var w=u[_],y=e[w];fe(x,w)!==y&&(ae(x,w,y),A=!0)}return A}}var s=r.table.core,c=s.schema.primaryKey,f=c.outbound,l=c.extractKey,p=n.db._options.modifyChunkSize||200,E=[],v=0,d=[],g=function(x,A){var _=A.failures;v+=x-A.numFailures;for(var y=0,C=Y(_);y<C.length;y++)E.push(_[C[y]])};return n.clone().primaryKeys().then(function(x){var A=function(_){var w=Math.min(p,x.length-_);return s.getMany({trans:i,keys:x.slice(_,_+w),cache:"immutable"}).then(function(y){for(var C=[],P=[],T=f?[]:null,K=[],R=0;R<w;++R){var L=y[R],b={value:ze(L),primKey:x[_+R]};!1!==a.call(b,b.value,b)&&(null==b.value?K.push(x[_+R]):f||0===J(l(L),l(b.value))?(P.push(b.value),f&&T.push(x[_+R])):(K.push(x[_+R]),C.push(b.value)))}var h=Ue(r)&&r.limit===1/0&&("function"!=typeof e||e===fn)&&{index:r.index,range:r.range};return Promise.resolve(C.length>0&&s.mutate({trans:i,type:"add",values:C}).then(function(S){for(var m in S.failures)K.splice(parseInt(m),1);g(C.length,S)})).then(function(){return(P.length>0||h&&"object"==typeof e)&&s.mutate({trans:i,type:"put",keys:T,values:P,criteria:h,changeSpec:"function"!=typeof e&&e}).then(function(S){return g(P.length,S)})}).then(function(){return(K.length>0||h&&e===fn)&&s.mutate({trans:i,type:"delete",keys:K,criteria:h}).then(function(S){return g(K.length,S)})}).then(function(){return x.length>_+w&&A(_+p)})})};return A(0).then(function(){if(E.length>0)throw new ht("Error modifying one or more objects",E,v,d);return x.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return Ue(e)&&(e.isPrimKey&&!ri||3===n.type)?this._write(function(r){var a=n;return e.table.core.count({trans:r,query:{index:e.table.core.schema.primaryKey,range:a}}).then(function(u){return e.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(o){var s=o.failures,c=o.numFailures;if(c)throw new ht("Could not delete some values",Object.keys(s).map(function(f){return s[f]}),u-c);return u-c})})}):this.modify(fn)},t}(),fn=function(t,e){return e.value=null};function fi(t,e){return t<e?-1:t===e?0:1}function hi(t,e){return t>e?-1:t===e?0:1}function ne(t,e,n){var r=t instanceof dr?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function He(t){return new t.Collection(t,function(){return hr("")}).limit(0)}function vi(t,e,n,r,i,a){for(var u=Math.min(t.length,r.length),o=-1,s=0;s<u;++s){var c=e[s];if(c!==r[s])return i(t[s],n[s])<0?t.substr(0,s)+n[s]+n.substr(s+1):i(t[s],r[s])<0?t.substr(0,s)+r[s]+n.substr(s+1):o>=0?t.substr(0,o)+e[o]+n.substr(o+1):null;i(t[s],c)<0&&(o=s)}return u<r.length&&"next"===a?t+n.substr(t.length):u<t.length&&"prev"===a?t.substr(0,n.length):o<0?null:t.substr(0,o)+r[o]+n.substr(o+1)}function Dt(t,e,n,r){var i,a,u,o,s,c,f,l=n.length;if(!n.every(function(d){return"string"==typeof d}))return ne(t,ar);function p(d){i=function(t){return"next"===t?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(d),a=function(t){return"next"===t?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(d),u="next"===d?fi:hi;var g=n.map(function(x){return{lower:a(x),upper:i(x)}}).sort(function(x,A){return u(x.lower,A.lower)});o=g.map(function(x){return x.upper}),s=g.map(function(x){return x.lower}),c=d,f="next"===d?"":r}p("next");var E=new t.Collection(t,function(){return we(o[0],s[l-1]+r)});E._ondirectionchange=function(d){p(d)};var v=0;return E._addAlgorithm(function(d,g,x){var A=d.key;if("string"!=typeof A)return!1;var _=a(A);if(e(_,s,v))return!0;for(var w=null,y=v;y<l;++y){var C=vi(A,_,o[y],s[y],u,c);null===C&&null===w?v=y+1:(null===w||u(w,C)>0)&&(w=C)}return g(null!==w?function(){d.continue(w+f)}:x),!1}),E}function we(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function hr(t){return{type:1,lower:t,upper:t}}var dr=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,i){r=!1!==r,i=!0===i;try{return this._cmp(e,n)>0||0===this._cmp(e,n)&&(r||i)&&(!r||!i)?He(this):new this.Collection(this,function(){return we(e,n,!r,!i)})}catch(a){return ne(this,pe)}},t.prototype.equals=function(e){return null==e?ne(this,pe):new this.Collection(this,function(){return hr(e)})},t.prototype.above=function(e){return null==e?ne(this,pe):new this.Collection(this,function(){return we(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return null==e?ne(this,pe):new this.Collection(this,function(){return we(e,void 0,!1)})},t.prototype.below=function(e){return null==e?ne(this,pe):new this.Collection(this,function(){return we(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return null==e?ne(this,pe):new this.Collection(this,function(){return we(void 0,e)})},t.prototype.startsWith=function(e){return"string"!=typeof e?ne(this,ar):this.between(e,e+ke,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Dt(this,function(n,r){return 0===n.indexOf(r[0])},[e],ke)},t.prototype.equalsIgnoreCase=function(e){return Dt(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=he.apply(Be,arguments);return 0===e.length?He(this):Dt(this,function(n,r){return-1!==r.indexOf(n)},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=he.apply(Be,arguments);return 0===e.length?He(this):Dt(this,function(n,r){return r.some(function(i){return 0===n.indexOf(i)})},e,ke)},t.prototype.anyOf=function(){var e=this,n=he.apply(Be,arguments),r=this._cmp;try{n.sort(r)}catch(u){return ne(this,pe)}if(0===n.length)return He(this);var i=new this.Collection(this,function(){return we(n[0],n[n.length-1])});i._ondirectionchange=function(u){n.sort(r="next"===u?e._ascending:e._descending)};var a=0;return i._addAlgorithm(function(u,o,s){for(var c=u.key;r(c,n[a])>0;)if(++a===n.length)return o(s),!1;return 0===r(c,n[a])||(o(function(){u.continue(n[a])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[un,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=he.apply(Be,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(r){return ne(this,pe)}var n=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[un,i]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,i=this._cmp,a=this._ascending,u=this._descending,o=this._min,s=this._max;if(0===e.length)return He(this);if(!e.every(function(y){return void 0!==y[0]&&void 0!==y[1]&&a(y[0],y[1])<=0}))return ne(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",M.InvalidArgument);var v,c=!n||!1!==n.includeLowers,f=n&&!0===n.includeUppers,p=a;function E(y,C){return p(y[0],C[0])}try{(v=e.reduce(function(y,C){for(var P=0,T=y.length;P<T;++P){var K=y[P];if(i(C[0],K[1])<0&&i(C[1],K[0])>0){K[0]=o(K[0],C[0]),K[1]=s(K[1],C[1]);break}}return P===T&&y.push(C),y},[])).sort(E)}catch(y){return ne(this,pe)}var d=0,g=f?function(y){return a(y,v[d][1])>0}:function(y){return a(y,v[d][1])>=0},x=c?function(y){return u(y,v[d][0])>0}:function(y){return u(y,v[d][0])>=0},_=g,w=new this.Collection(this,function(){return we(v[0][0],v[v.length-1][1],!c,!f)});return w._ondirectionchange=function(y){"next"===y?(_=g,p=a):(_=x,p=u),v.sort(E)},w._addAlgorithm(function(y,C,P){for(var T=y.key;_(T);)if(++d===v.length)return C(P),!1;return!!function(y){return!g(y)&&!x(y)}(T)||(0===r._cmp(T,v[d][1])||0===r._cmp(T,v[d][0])||C(function(){y.continue(p===a?v[d][0]:v[d][1])}),!1)}),w},t.prototype.startsWithAnyOf=function(){var e=he.apply(Be,arguments);return e.every(function(n){return"string"==typeof n})?0===e.length?He(this):this.inAnyRange(e.map(function(n){return[n,n+ke]})):ne(this,"startsWithAnyOf() only works with strings")},t}();function oe(t){return z(function(e){return nt(e),t(e.target.error),!1})}function nt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var rt="storagemutated",Ee="x-storagemutated-1",xe=et(null,rt),mi=function(){function t(){}return t.prototype._lock=function(){return We(!O.global),++this._reculock,1===this._reculock&&!O.global&&(O.lockOwnerFor=this),this},t.prototype._unlock=function(){if(We(!O.global),0==--this._reculock)for(O.global||(O.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Le(e[1],e[0])}catch(n){}}return this},t.prototype._locked=function(){return this._reculock&&O.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(We(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new M.DatabaseClosed(i);case"MissingAPIError":throw new M.MissingAPI(i.message,i);default:throw new M.OpenFailed(i)}if(!this.active)throw new M.TransactionInactive;return We(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=z(function(a){nt(a),n._reject(e.error)}),e.onabort=z(function(a){nt(a),n.active&&n._reject(new M.Abort(e.error)),n.active=!1,n.on("abort").fire(a)}),e.oncomplete=z(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&xe.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var i=this;if("readwrite"===e&&"readwrite"!==this.mode)return q(new M.ReadOnly("Transaction is readonly"));if(!this.active)return q(new M.TransactionInactive);if(this._locked())return new k(function(u,o){i._blockedFuncs.push([function(){i._promise(e,n,r).then(u,o)},O])});if(r)return be(function(){var u=new k(function(o,s){i._lock();var c=n(o,s,i);c&&c.then&&c.then(o,s)});return u.finally(function(){return i._unlock()}),u._lib=!0,u});var a=new k(function(u,o){var s=n(u,o,i);s&&s.then&&s.then(u,o)});return a._lib=!0,a},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=k.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);!function u(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=u)}()}var a=n._waitingFor;return new k(function(u,o){r.then(function(s){return n._waitingQueue.push(z(u.bind(null,s)))},function(s){return n._waitingQueue.push(z(o.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new M.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(re(n,e))return n[e];var r=this.schema[e];if(!r)throw new M.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i},t}();function hn(t,e,n,r,i,a,u){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:a,src:(n&&!u?"&":"")+(r?"*":"")+(i?"++":"")+pr(e)}}function pr(t){return"string"==typeof t?t:t?"["+[].join.call(t,"+")+"]":""}function vr(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Mn(n,function(r){return[r.name,r]})}}var it=function(t){try{return t.only([[]]),it=function(){return[[]]},[[]]}catch(e){return it=function(){return ke},ke}};function dn(t){return null==t?function(){}:"string"==typeof t?function(t){return 1===t.split(".").length?function(n){return n[t]}:function(n){return fe(n,t)}}(t):function(e){return fe(e,t)}}function yr(t){return[].slice.call(t)}var wi=0;function at(t){return null==t?":id":"string"==typeof t?t:"["+t.join("+")+"]"}function Si(t,e,n,r){var a=function(t,e){return e.reduce(function(n,r){var i=r.create;return N(N({},n),i(n))},t)}(function(t,e,n){function i(l){if(3===l.type)return null;if(4===l.type)throw new Error("Cannot convert never type to IDBKeyRange");var p=l.lower,E=l.upper,v=l.lowerOpen,d=l.upperOpen;return void 0===p?void 0===E?null:e.upperBound(E,!!d):void 0===E?e.lowerBound(p,!!v):e.bound(p,E,!!v,!!d)}var l,p,E,u=(p=n,E=yr((l=t).objectStoreNames),{schema:{name:l.name,tables:E.map(function(v){return p.objectStore(v)}).map(function(v){var d=v.keyPath,g=v.autoIncrement,x=X(d),_={},w={name:v.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==d,compound:x,keyPath:d,autoIncrement:g,unique:!0,extractKey:dn(d)},indexes:yr(v.indexNames).map(function(y){return v.index(y)}).map(function(y){var P=y.unique,T=y.multiEntry,K=y.keyPath,L={name:y.name,compound:X(K),keyPath:K,unique:P,multiEntry:T,extractKey:dn(K)};return _[at(K)]=L,L}),getIndexByKeyPath:function(y){return _[at(y)]}};return _[":id"]=w.primaryKey,null!=d&&(_[at(d)]=w.primaryKey),w})},hasGetAll:E.length>0&&"getAll"in p.objectStore(E[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),o=u.schema,s=u.hasGetAll,c=o.tables.map(function(l){return function(l){var g,p=l.name;return{name:p,schema:l,mutate:function(g){var x=g.trans,A=g.type,_=g.keys,w=g.values,y=g.range;return new Promise(function(C,P){C=z(C);var T=x.objectStore(p),K=null==T.keyPath,R="put"===A||"add"===A;if(!R&&"delete"!==A&&"deleteRange"!==A)throw new Error("Invalid operation type: "+A);var L=(_||w||{length:1}).length;if(_&&w&&_.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(0===L)return C({numFailures:0,failures:{},results:[],lastResult:void 0});var b,h=[],S=[],m=0,D=function(W){++m,nt(W)};if("deleteRange"===A){if(4===y.type)return C({numFailures:m,failures:S,results:[],lastResult:void 0});h.push(b=3===y.type?T.clear():T.delete(i(y)))}else{var I=R?K?[w,_]:[w,null]:[_,null],B=I[0],j=I[1];if(R)for(var F=0;F<L;++F)h.push(b=j&&void 0!==j[F]?T[A](B[F],j[F]):T[A](B[F])),b.onerror=D;else for(F=0;F<L;++F)h.push(b=T[A](B[F])),b.onerror=D}var H=function(W){var ee=W.target.result;h.forEach(function(G,Ie){return null!=G.error&&(S[Ie]=G.error)}),C({numFailures:m,failures:S,results:"delete"===A?_:h.map(function(G){return G.result}),lastResult:ee})};b.onerror=function(W){D(W),H(W)},b.onsuccess=H})},getMany:function(g){var x=g.trans,A=g.keys;return new Promise(function(_,w){_=z(_);for(var R,y=x.objectStore(p),C=A.length,P=new Array(C),T=0,K=0,L=function(m){var D=m.target;P[D._pos]=D.result,++K===T&&_(P)},b=oe(w),h=0;h<C;++h)null!=A[h]&&((R=y.get(A[h]))._pos=h,R.onsuccess=L,R.onerror=b,++T);0===T&&_(P)})},get:function(g){var x=g.trans,A=g.key;return new Promise(function(_,w){_=z(_);var C=x.objectStore(p).get(A);C.onsuccess=function(P){return _(P.target.result)},C.onerror=oe(w)})},query:(g=s,function(x){return new Promise(function(A,_){A=z(A);var y=x.values,C=x.limit,P=x.query,T=C===1/0?void 0:C,K=P.index,R=P.range,L=x.trans.objectStore(p),b=K.isPrimaryKey?L:L.index(K.name),h=i(R);if(0===C)return A({result:[]});if(g){var S=y?b.getAll(h,T):b.getAllKeys(h,T);S.onsuccess=function(B){return A({result:B.target.result})},S.onerror=oe(_)}else{var m=0,D=y||!("openKeyCursor"in b)?b.openCursor(h):b.openKeyCursor(h),I=[];D.onsuccess=function(B){var j=D.result;return j?(I.push(y?j.value:j.primaryKey),++m===C?A({result:I}):void j.continue()):A({result:I})},D.onerror=oe(_)}})}),openCursor:function(g){var x=g.trans,A=g.values,_=g.query,w=g.reverse,y=g.unique;return new Promise(function(C,P){C=z(C);var T=_.index,K=_.range,R=x.objectStore(p),L=T.isPrimaryKey?R:R.index(T.name),b=w?y?"prevunique":"prev":y?"nextunique":"next",h=A||!("openKeyCursor"in L)?L.openCursor(i(K),b):L.openKeyCursor(i(K),b);h.onerror=oe(P),h.onsuccess=z(function(S){var m=h.result;if(m){m.___id=++wi,m.done=!1;var D=m.continue.bind(m),I=m.continuePrimaryKey;I&&(I=I.bind(m));var B=m.advance.bind(m),F=function(){throw new Error("Cursor not stopped")};m.trans=x,m.stop=m.continue=m.continuePrimaryKey=m.advance=function(){throw new Error("Cursor not started")},m.fail=z(P),m.next=function(){var H=this,W=1;return this.start(function(){return W--?H.continue():H.stop()}).then(function(){return H})},m.start=function(H){var W=new Promise(function(G,Ie){G=z(G),h.onerror=oe(Ie),m.fail=Ie,m.stop=function(Bt){m.stop=m.continue=m.continuePrimaryKey=m.advance=F,G(Bt)}}),ee=function(){if(h.result)try{H()}catch(G){m.fail(G)}else m.done=!0,m.start=function(){throw new Error("Cursor behind last entry")},m.stop()};return h.onsuccess=z(function(G){h.onsuccess=ee,ee()}),m.continue=D,m.continuePrimaryKey=I,m.advance=B,ee(),W},C(m)}else C(null)},P)})},count:function(g){var x=g.query,A=g.trans,_=x.index,w=x.range;return new Promise(function(y,C){var P=A.objectStore(p),T=_.isPrimaryKey?P:P.index(_.name),K=i(w),R=K?T.count(K):T.count();R.onsuccess=z(function(L){return y(L.target.result)}),R.onerror=oe(C)})}}}(l)}),f={};return c.forEach(function(l){return f[l.name]=l}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(l){if(!f[l])throw new Error("Table '"+l+"' not found");return f[l]},MIN_KEY:-1/0,MAX_KEY:it(e),schema:o}}(e,n.IDBKeyRange,r),t.dbcore);return{dbcore:a}}function pn(t,e){var n=t._novip,i=Si(n._middlewares,e.db,n._deps,e);n.core=i.dbcore,n.tables.forEach(function(a){var u=a.name;n.core.schema.tables.some(function(o){return o.name===u})&&(a.core=n.core.table(u),n[u]instanceof n.Table&&(n[u].core=a.core))})}function It(t,e,n,r){var i=t._novip;n.forEach(function(a){var u=r[a];e.forEach(function(o){var s=jt(o,a);(!s||"value"in s&&void 0===s.value)&&(o===i.Transaction.prototype||o instanceof i.Transaction?le(o,a,{get:function(){return this.table(a)},set:function(c){Rn(this,a,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):o[a]=new i.Table(a,u))})})}function vn(t,e){var n=t._novip;e.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Ai(t,e){return t._cfg.version-e._cfg.version}function mr(t,e){var r,n={del:[],add:[],change:[]};for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],a=e[r];if(i){var u={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!At)u.recreate=!0,n.change.push(u);else{var o=i.idxByName,s=a.idxByName,c=void 0;for(c in o)s[c]||u.del.push(c);for(c in s){var f=o[c],l=s[c];f?f.src!==l.src&&u.change.push(l):u.add.push(l)}(u.del.length>0||u.add.length>0||u.change.length>0)&&n.change.push(u)}}else n.add.push([r,a])}return n}function yn(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return mn(i,a)}),i}function mn(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function gn(t,e,n){var r={};return ft(e.objectStoreNames,0).forEach(function(a){for(var u=n.objectStore(a),o=u.keyPath,s=hn(pr(o),o||"",!1,!1,!!u.autoIncrement,o&&"string"!=typeof o,!0),c=[],f=0;f<u.indexNames.length;++f){var l=u.index(u.indexNames[f]),p=hn(l.name,o=l.keyPath,!!l.unique,!!l.multiEntry,!1,o&&"string"!=typeof o,!1);c.push(p)}r[a]=vr(a,s,c)}),r}function bn(t,e,n){for(var r=t._novip,i=n.db.objectStoreNames,a=0;a<i.length;++a){var u=i[a],o=n.objectStore(u);r._hasGetAll="getAll"in o;for(var s=0;s<o.indexNames.length;++s){var c=o.indexNames[s],f=o.index(c).keyPath,l="string"==typeof f?f:"["+ft(f).join("+")+"]";if(e[u]){var p=e[u].idxByName[l];p&&(p.name=c,delete e[u].idxByName[l],e[u].idxByName[c]=p)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&V.WorkerGlobalScope&&V instanceof V.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}var Ri=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){Y(e).forEach(function(r){if(null!==e[r]){var i=function(t){return t.split(",").map(function(e,n){var r=(e=e.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return hn(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),X(i),0===n)})}(e[r]),a=i.shift();if(a.multi)throw new M.Schema("Primary key cannot be multi-valued");i.forEach(function(u){if(u.auto)throw new M.Schema("Only primary key can be marked as autoIncrement (++)");if(!u.keyPath)throw new M.Schema("Index must have a name and cannot be an empty string")}),n[r]=vr(r,a,i)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?Z(this._cfg.storesSource,e):e;var i={},a={};return n._versions.forEach(function(u){Z(i,u._cfg.storesSource),a=u._cfg.dbschema={},u._parseStoresSpec(i,a)}),n._dbSchema=a,vn(n,[n._allTables,n,n.Transaction.prototype]),It(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Y(a),a),n._storeNames=Y(a),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=zt(this._cfg.contentUpgrade||U,e),this},t}();function _n(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new kn(Ct,{addons:[],indexedDB:t,IDBKeyRange:e})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function wn(t){return t&&"function"==typeof t.databases}function Fi(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!wn(n)&&e!==Ct&&_n(n,r).delete(e).catch(U)}function En(t){return be(function(){return O.letThrough=!0,t()})}function ji(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function Ni(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?q(e.dbOpenError):t});ue&&(e.openCanceller._stackHolder=Me()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new M.DatabaseClosed("db.open() was cancelled")}var a=e.dbReadyResolve,u=null,o=!1;return k.race([r,("undefined"==typeof navigator?k.resolve():ji()).then(function(){return new k(function(s,c){if(i(),!n)throw new M.MissingAPI;var f=t.name,l=e.autoSchema?n.open(f):n.open(f,Math.round(10*t.verno));if(!l)throw new M.MissingAPI;l.onerror=oe(c),l.onblocked=z(t._fireOnBlocked),l.onupgradeneeded=z(function(p){if(u=l.transaction,e.autoSchema&&!t._options.allowEmptyDB){l.onerror=nt,u.abort(),l.result.close();var E=n.deleteDatabase(f);E.onsuccess=E.onerror=z(function(){c(new M.NoSuchDatabase("Database "+f+" doesnt exist"))})}else{u.onerror=oe(c);var v=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;o=v<1,t._novip.idbdb=l.result,function(t,e,n,r){var i=t._dbSchema,a=t._createTransaction("readwrite",t._storeNames,i);a.create(n),a._completion.catch(r);var u=a._reject.bind(a),o=O.transless||O;be(function(){O.trans=a,O.transless=o,0===e?(Y(i).forEach(function(s){yn(n,s,i[s].primKey,i[s].indexes)}),pn(t,n),k.follow(function(){return t.on.populate.fire(a)}).catch(u)):function(t,e,n,r){var i=t._novip,a=[],u=i._versions,o=i._dbSchema=gn(0,i.idbdb,r),s=!1;return u.filter(function(l){return l._cfg.version>=e}).forEach(function(l){a.push(function(){var p=o,E=l._cfg.dbschema;bn(i,p,r),bn(i,E,r),o=i._dbSchema=E;var v=mr(p,E);v.add.forEach(function(w){yn(r,w[0],w[1].primKey,w[1].indexes)}),v.change.forEach(function(w){if(w.recreate)throw new M.Upgrade("Not yet support for changing primary key");var y=r.objectStore(w.name);w.add.forEach(function(C){return mn(y,C)}),w.change.forEach(function(C){y.deleteIndex(C.name),mn(y,C)}),w.del.forEach(function(C){return y.deleteIndex(C)})});var d=l._cfg.contentUpgrade;if(d&&l._cfg.version>e){pn(i,r),n._memoizedTables={},s=!0;var g=Fn(E);v.del.forEach(function(w){g[w]=p[w]}),vn(i,[i.Transaction.prototype]),It(i,[i.Transaction.prototype],Y(g),g),n.schema=g;var x=Ht(d);x&&Ne();var A,_=k.follow(function(){if((A=d(n))&&x){var w=de.bind(null,null);A.then(w,w)}});return A&&"function"==typeof A.then?k.resolve(A):_.then(function(){return A})}}),a.push(function(p){s&&ni||function(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return null==t[n]&&e.db.deleteObjectStore(n)})}(l._cfg.dbschema,p),vn(i,[i.Transaction.prototype]),It(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})}),function f(){return a.length?k.resolve(a.shift()(n.idbtrans)).then(f):k.resolve()}().then(function(){!function(t,e){Y(t).forEach(function(n){e.db.objectStoreNames.contains(n)||yn(e,n,t[n].primKey,t[n].indexes)})}(o,r)})}(t,e,a,n).catch(u)})}(t,v/10,u,c)}},c),l.onsuccess=z(function(){u=null;var p=t._novip.idbdb=l.result,E=ft(p.objectStoreNames);if(E.length>0)try{var v=p.transaction(function(t){return 1===t.length?t[0]:t}(E),"readonly");e.autoSchema?function(t,e,n){var r=t._novip;r.verno=e.version/10;var i=r._dbSchema=gn(0,e,n);r._storeNames=ft(e.objectStoreNames,0),It(r,[r._allTables],Y(i),i)}(t,p,v):(bn(t,t._dbSchema,v),function(t,e){var r=mr(gn(0,t.idbdb,e),t._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}(t,v)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),pn(t,v)}catch(d){}Je.push(t),p.onversionchange=z(function(d){e.vcFired=!0,t.on("versionchange").fire(d)}),p.onclose=z(function(d){t.on("close").fire(d)}),o&&function(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!wn(n)&&e!==Ct&&_n(n,r).put({name:e}).catch(U)}(t._deps,f),s()},c)})})]).then(function(){return i(),e.onReadyBeingFired=[],k.resolve(En(function(){return t.on.ready.fire(t.vip)})).then(function s(){if(e.onReadyBeingFired.length>0){var c=e.onReadyBeingFired.reduce(zt,U);return e.onReadyBeingFired=[],k.resolve(En(function(){return c(t.vip)})).then(s)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(s){e.dbOpenError=s;try{u&&u.abort()}catch(c){}return r===e.openCanceller&&t._close(),q(s)}).finally(function(){e.openComplete=!0,a()})}function xn(t){var e=function(u){return t.next(u)},r=a(e),i=a(function(u){return t.throw(u)});function a(u){return function(o){var s=u(o),c=s.value;return s.done?c:c&&"function"==typeof c.then?c.then(r,i):X(c)?Promise.all(c).then(r,i):r(c)}}return a(e)()}function Li(t,e,n){var r=arguments.length;if(r<2)throw new M.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=jn(i);return[t,a,n]}function Ui(t,e,n,r,i){return k.resolve().then(function(){var a=O.transless||O,u=t._createTransaction(e,n,t._dbSchema,r),o={trans:u,transless:a};r?u.idbtrans=r.idbtrans:u.create();var s=Ht(i);s&&Ne();var c,f=k.follow(function(){if(c=i.call(u,u))if(s){var l=de.bind(null,null);c.then(l,l)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=xn(c))},o);return(c&&"function"==typeof c.then?k.resolve(c).then(function(l){return u.active?l:q(new M.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):f.then(function(){return c})).then(function(l){return r&&u._resolve(),u._completion.then(function(){return l})}).catch(function(l){return u._reject(l),q(l)})})}function Pt(t,e,n){for(var r=X(t)?t.slice():[t],i=0;i<n;++i)r.push(e);return r}var Vi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return N(N({},t),{table:function(e){var n=t.table(e),r=n.schema,i={},a=[];function u(d,g,x){var A=at(d),_=i[A]=i[A]||[],w=null==d?0:"string"==typeof d?1:d.length,y=g>0,C=N(N({},x),{isVirtual:y,keyTail:g,keyLength:w,extractKey:dn(d),unique:!y&&x.unique});return _.push(C),C.isPrimaryKey||a.push(C),w>1&&u(2===w?d[0]:d.slice(0,w-1),g+1,x),_.sort(function(T,K){return T.keyTail-K.keyTail}),C}var o=u(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[o];for(var s=0,c=r.indexes;s<c.length;s++){var f=c[s];u(f.keyPath,0,f)}function p(d,g){return{type:1===d.type?2:d.type,lower:Pt(d.lower,d.lowerOpen?t.MAX_KEY:t.MIN_KEY,g),lowerOpen:!0,upper:Pt(d.upper,d.upperOpen?t.MIN_KEY:t.MAX_KEY,g),upperOpen:!0}}function E(d){var g=d.query.index;return g.isVirtual?N(N({},d),{query:{index:g,range:p(d.query.range,g.keyTail)}}):d}return N(N({},n),{schema:N(N({},r),{primaryKey:o,indexes:a,getIndexByKeyPath:function(d){var g=i[at(d)];return g&&g[0]}}),count:function(d){return n.count(E(d))},query:function(d){return n.query(E(d))},openCursor:function(d){var g=d.query.index,x=g.keyTail,_=g.keyLength;return g.isVirtual?n.openCursor(E(d)).then(function(y){return y&&function(y){return Object.create(y,{continue:{value:function(T){null!=T?y.continue(Pt(T,d.reverse?t.MAX_KEY:t.MIN_KEY,x)):d.unique?y.continue(y.key.slice(0,_).concat(d.reverse?t.MIN_KEY:t.MAX_KEY,x)):y.continue()}},continuePrimaryKey:{value:function(T,K){y.continuePrimaryKey(Pt(T,t.MAX_KEY,x),K)}},primaryKey:{get:function(){return y.primaryKey}},key:{get:function(){var T=y.key;return 1===_?T[0]:T.slice(0,_)}},value:{get:function(){return y.value}}})}(y)}):n.openCursor(d)}})}})}};function Sn(t,e,n,r){return n=n||{},r=r||"",Y(t).forEach(function(i){if(re(e,i)){var a=t[i],u=e[i];if("object"==typeof a&&"object"==typeof u&&a&&u){var o=Lt(a);o!==Lt(u)?n[r+i]=e[i]:"Object"===o?Sn(a,u,n,r+i+"."):a!==u&&(n[r+i]=e[i])}else a!==u&&(n[r+i]=e[i])}else n[r+i]=void 0}),Y(e).forEach(function(i){re(t,i)||(n[r+i]=e[i])}),n}var zi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return N(N({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,i=N(N({},n),{mutate:function(a){var u=O.trans,o=u.table(e).hook,s=o.deleting,c=o.creating,f=o.updating;switch(a.type){case"add":if(c.fire===U)break;return u._promise("readwrite",function(){return l(a)},!0);case"put":if(c.fire===U&&f.fire===U)break;return u._promise("readwrite",function(){return l(a)},!0);case"delete":if(s.fire===U)break;return u._promise("readwrite",function(){return l(a)},!0);case"deleteRange":if(s.fire===U)break;return u._promise("readwrite",function(){return E((v=a).trans,v.range,1e4);var v},!0)}return n.mutate(a);function l(v){var d=O.trans,g=v.keys||function(t,e){return"delete"===e.type?e.keys:e.keys||e.values.map(t.extractKey)}(r,v);if(!g)throw new Error("Keys missing");return"delete"!==(v="add"===v.type||"put"===v.type?N(N({},v),{keys:g}):N({},v)).type&&(v.values=Ft([],v.values,!0)),v.keys&&(v.keys=Ft([],v.keys,!0)),function(t,e,n){return"add"===e.type?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}(n,v,g).then(function(x){var A=g.map(function(_,w){var y=x[w],C={onerror:null,onsuccess:null};if("delete"===v.type)s.fire.call(C,_,y,d);else if("add"===v.type||void 0===y){var P=c.fire.call(C,_,v.values[w],d);null==_&&null!=P&&(v.keys[w]=_=P,r.outbound||ae(v.values[w],r.keyPath,_))}else{var T=Sn(y,v.values[w]),K=f.fire.call(C,T,_,y,d);if(K){var R=v.values[w];Object.keys(K).forEach(function(L){re(R,L)?R[L]=K[L]:ae(R,L,K[L])})}}return C});return n.mutate(v).then(function(_){for(var w=_.failures,y=_.results,C=_.numFailures,P=_.lastResult,T=0;T<g.length;++T){var K=y?y[T]:g[T],R=A[T];null==K?R.onerror&&R.onerror(w[T]):R.onsuccess&&R.onsuccess("put"===v.type&&x[T]?v.values[T]:K)}return{failures:w,results:y,numFailures:C,lastResult:P}}).catch(function(_){return A.forEach(function(w){return w.onerror&&w.onerror(_)}),Promise.reject(_)})})}function E(v,d,g){return n.query({trans:v,values:!1,query:{index:r,range:d},limit:g}).then(function(x){var A=x.result;return l({type:"delete",keys:A,trans:v}).then(function(_){return _.numFailures>0?Promise.reject(_.failures[0]):A.length<g?{failures:[],numFailures:0,lastResult:void 0}:E(v,N(N({},d),{lower:A[A.length-1],lowerOpen:!0}),g)})})}}});return i}})}};function gr(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],i=0,a=0;i<e.keys.length&&a<t.length;++i)0===J(e.keys[i],t[a])&&(r.push(n?ze(e.values[i]):e.values[i]),++a);return r.length===t.length?r:null}catch(u){return null}}var An,Gi={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return N(N({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=gr(r.keys,r.trans._cache,"clone"===r.cache);return i?k.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:"clone"===r.cache?ze(a):a},a})},mutate:function(r){return"add"!==r.type&&(r.trans._cache=null),n.mutate(r)}})}}}};function Cn(t){return!("from"in t)}var ve=function(t,e){if(!this){var n=new ve;return t&&"d"in t&&Z(n,t),n}Z(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function ut(t,e,n){var r=J(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Cn(t))return Z(t,{from:e,to:n,d:1});var i=t.l,a=t.r;if(J(n,t.from)<0)return i?ut(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},br(t);if(J(e,t.to)>0)return a?ut(a,e,n):t.r={from:e,to:n,d:1,l:null,r:null},br(t);J(e,t.from)<0&&(t.from=e,t.l=null,t.d=a?a.d+1:1),J(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var u=!t.r;i&&!t.l&&Rt(t,i),a&&u&&Rt(t,a)}}function Rt(t,e){Cn(e)||function n(r,i){var o=i.l,s=i.r;ut(r,i.from,i.to),o&&n(r,o),s&&n(r,s)}(t,e)}function Tn(t){var e=Cn(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&J(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||J(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function br(t){var e,n,r=((null===(e=t.r)||void 0===e?void 0:e.d)||0)-((null===(n=t.l)||void 0===n?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a="r"===i?"l":"r",u=N({},t),o=t[i];t.from=o.from,t.to=o.to,t[i]=o[i],u[i]=o[a],t[a]=u,u.d=_r(u)}t.d=_r(t)}function _r(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}Re(ve.prototype,(An={add:function(t){return Rt(this,t),this},addKey:function(t){return ut(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return ut(e,n,n)}),this}},An[Ut]=function(){return Tn(this)},An));var Dn,Qi={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new ve(t.MIN_KEY,t.MAX_KEY);return N(N({},t),{table:function(r){var i=t.table(r),a=i.schema,u=a.primaryKey,o=u.extractKey,s=u.outbound,c=N(N({},i),{mutate:function(p){var E=p.trans,v=E.mutatedParts||(E.mutatedParts={}),d=function(P){var T="idb://"+e+"/"+r+"/"+P;return v[T]||(v[T]=new ve)},g=d(""),x=d(":dels"),A=p.type,_="deleteRange"===p.type?[p.range]:"delete"===p.type?[p.keys]:p.values.length<50?[[],p.values]:[],w=_[0],y=_[1],C=p.trans._cache;return i.mutate(p).then(function(P){if(X(w)){"delete"!==A&&(w=P.results),g.addKeys(w);var T=gr(w,C);!T&&"add"!==A&&x.addKeys(w),(T||y)&&function(t,e,n,r){e.indexes.forEach(function(a){var u=t(a.name||"");function o(c){return null!=c?a.extractKey(c):null}var s=function(c){return a.multiEntry&&X(c)?c.forEach(function(f){return u.addKey(f)}):u.addKey(c)};(n||r).forEach(function(c,f){var l=n&&o(n[f]),p=r&&o(r[f]);0!==J(l,p)&&(null!=l&&s(l),null!=p&&s(p))})})}(d,a,T,y)}else if(w){var K={from:w.lower,to:w.upper};x.add(K),g.add(K)}else g.add(n),x.add(n),a.indexes.forEach(function(R){return d(R.name).add(n)});return P})}}),f=function(p){var E,v,d=p.query,x=d.range;return[d.index,new ve(null!==(E=x.lower)&&void 0!==E?E:t.MIN_KEY,null!==(v=x.upper)&&void 0!==v?v:t.MAX_KEY)]},l={get:function(p){return[u,new ve(p.key)]},getMany:function(p){return[u,(new ve).addKeys(p.keys)]},count:f,query:f,openCursor:f};return Y(l).forEach(function(p){c[p]=function(E){var v=O.subscr;if(v){var d=function(C){var P="idb://"+e+"/"+r+"/"+C;return v[P]||(v[P]=new ve)},g=d(""),x=d(":dels"),A=l[p](E),_=A[0],w=A[1];if(d(_.name||"").add(w),!_.isPrimaryKey){if("count"!==p){var y="query"===p&&s&&E.values&&i.query(N(N({},E),{values:!1}));return i[p].apply(this,arguments).then(function(C){if("query"===p){if(s&&E.values)return y.then(function(R){return g.addKeys(R.result),C});var P=E.values?C.result.map(o):C.result;E.values?g.addKeys(P):x.addKeys(P)}else if("openCursor"===p){var T=C,K=E.values;return T&&Object.create(T,{key:{get:function(){return x.addKey(T.primaryKey),T.key}},primaryKey:{get:function(){var R=T.primaryKey;return x.addKey(R),R}},value:{get:function(){return K&&g.addKey(T.primaryKey),T.value}}})}return C})}x.add(n)}}return i[p].apply(this,arguments)}}),c}})}},kn=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=n=N({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:U,dbReadyPromise:null,cancelOpen:U,openCanceller:null,autoSchema:!0};u.dbReadyPromise=new k(function(o){u.dbReadyResolve=o}),u.openCanceller=new k(function(o,s){u.cancelOpen=s}),this._state=u,this.name=e,this.on=et(this,"populate","blocked","versionchange","close",{ready:[zt,U]}),this.on.ready.subscribe=On(this.on.ready.subscribe,function(o){return function(s,c){t.vip(function(){var f=r._state;if(f.openComplete)f.dbOpenError||k.resolve().then(s),c&&o(s);else if(f.onReadyBeingFired)f.onReadyBeingFired.push(s),c&&o(s);else{o(s);var l=r;c||o(function p(){l.on.ready.unsubscribe(s),l.on.ready.unsubscribe(p)})}})}}),this.Collection=function(t){return tt(ci.prototype,function(n,r){this.db=t;var i=or,a=null;if(r)try{i=r()}catch(c){a=c}var u=n._ctx,o=u.table,s=o.hook.reading.fire;this._ctx={table:o,index:u.index,isPrimKey:!u.index||o.schema.primKey.keyPath&&u.index===o.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:u.or,valueMapper:s!==Ge?s:null}})}(this),this.Table=function(t){return tt(ii.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:et(null,{creating:[Ur,U],reading:[Lr,Ge],updating:[Vr,U],deleting:[Hr,U]})})}(this),this.Transaction=function(t){return tt(mi.prototype,function(n,r,i,a,u){var o=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=et(this,"complete","error","abort"),this.parent=u||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new k(function(s,c){o._resolve=s,o._reject=c}),this._completion.then(function(){o.active=!1,o.on.complete.fire()},function(s){var c=o.active;return o.active=!1,o.on.error.fire(s),o.parent?o.parent._reject(s):c&&o.idbtrans&&o.idbtrans.abort(),q(s)})})}(this),this.Version=function(t){return tt(Ri.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(t){return tt(dr.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:":id"===r?null:r,or:i};var a=t._deps.indexedDB;if(!a)throw new M.MissingAPI;this._cmp=this._ascending=a.cmp.bind(a),this._descending=function(u,o){return a.cmp(o,u)},this._max=function(u,o){return a.cmp(u,o)>0?u:o},this._min=function(u,o){return a.cmp(u,o)<0?u:o},this._IDBKeyRange=t._deps.IDBKeyRange})}(this),this.on("versionchange",function(o){o.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(o){!o.newVersion||o.newVersion<o.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+o.oldVersion/10)}),this._maxKey=it(n.IDBKeyRange),this._createTransaction=function(o,s,c,f){return new r.Transaction(o,s,c,r._options.chromeTransactionDurability,f)},this._fireOnBlocked=function(o){r.on("blocked").fire(o),Je.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(o)})},this.use(Vi),this.use(zi),this.use(Qi),this.use(Gi),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(function(o){return o(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new M.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new M.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(Ai),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||O.letThrough||this._vip)?e():new k(function(r,i){if(n._state.openComplete)return i(new M.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen)return void i(new M.DatabaseClosed);n.open().catch(U)}n._state.dbReadyPromise.then(r,i)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,i=e.level,a=e.name;a&&this.unuse({stack:n,name:a});var u=this._middlewares[n]||(this._middlewares[n]=[]);return u.push({stack:n,create:r,level:null==i?10:i,name:a}),u.sort(function(o,s){return o.level-s.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,i=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:!!r&&a.name!==r})),this},t.prototype.open=function(){return Ni(this)},t.prototype._close=function(){var e=this._state,n=Je.indexOf(this);if(n>=0&&Je.splice(n,1),this.idbdb){try{this.idbdb.close()}catch(r){}this._novip.idbdb=null}e.dbReadyPromise=new k(function(r){e.dbReadyResolve=r}),e.openCanceller=new k(function(r,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new M.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new k(function(i,a){var u=function(){e.close();var o=e._deps.indexedDB.deleteDatabase(e.name);o.onsuccess=z(function(){Fi(e._deps,e.name),i()}),o.onerror=oe(a),o.onblocked=e._fireOnBlocked};if(n)throw new M.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(u):u()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return null!==this.idbdb},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},t.prototype.hasFailed=function(){return null!==this._state.dbOpenError},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return Y(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=Li.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var i=this,a=O.trans;(!a||a.db!==this||-1!==e.indexOf("!"))&&(a=null);var o,s,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(s=n.map(function(f){var l=f instanceof i.Table?f.name:f;if("string"!=typeof l)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),"r"==e||e===on)o=on;else{if("rw"!=e&&e!=sn)throw new M.InvalidArgument("Invalid transaction mode: "+e);o=sn}if(a){if(a.mode===on&&o===sn){if(!u)throw new M.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&s.forEach(function(f){if(a&&-1===a.storeNames.indexOf(f)){if(!u)throw new M.SubTransaction("Table "+f+" not included in parent transaction.");a=null}}),u&&a&&!a.active&&(a=null)}}catch(f){return a?a._promise(null,function(l,p){p(f)}):q(f)}var c=Ui.bind(null,this,o,s,a,r);return a?a._promise(o,c,"lock"):O.trans?Le(O.transless,function(){return i._whenReady(c)}):this._whenReady(c)},t.prototype.table=function(e){if(!re(this._allTables,e))throw new M.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),$i="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",Zi=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:n,complete:r})},t.prototype[$i]=function(){return this},t}();function wr(t,e){return Y(e).forEach(function(n){Rt(t[n]||(t[n]=new ve),e[n])}),t}function Kn(t){return new Zi(function(e){var n=Ht(t),i=!1,a={},u={},o={get closed(){return i},unsubscribe:function(){i=!0,xe.storagemutated.unsubscribe(l)}};e.start&&e.start(o);var s=!1,c=!1;function f(){return Y(u).some(function(E){return a[E]&&function(t,e){var n=Tn(e),r=n.next();if(r.done)return!1;for(var i=r.value,a=Tn(t),u=a.next(i.from),o=u.value;!r.done&&!u.done;){if(J(o.from,i.to)<=0&&J(o.to,i.from)>=0)return!0;J(i.from,o.from)<0?i=(r=n.next(o.from)).value:o=(u=a.next(i.from)).value}return!1}(a[E],u[E])})}var l=function(E){wr(a,E),f()&&p()},p=function(){if(!s&&!i){a={};var E={},v=function(E){n&&Ne();var v=function(){return be(t,{subscr:E,trans:null})},d=O.trans?Le(O.transless,v):v();return n&&d.then(de,de),d}(E);c||(xe(rt,l),c=!0),s=!0,Promise.resolve(v).then(function(d){s=!1,!i&&(f()?p():(a={},u=E,e.next&&e.next(d)))},function(d){s=!1,e.error&&e.error(d),o.unsubscribe()})}};return p(),o})}try{Dn={indexedDB:V.indexedDB||V.mozIndexedDB||V.webkitIndexedDB||V.msIndexedDB,IDBKeyRange:V.IDBKeyRange||V.webkitIDBKeyRange}}catch(t){Dn={indexedDB:null,IDBKeyRange:null}}var De=kn;function Ot(t){var e=ye;try{ye=!0,xe.storagemutated.fire(t)}finally{ye=e}}Re(De,N(N({},dt),{delete:function(t){return new De(t,{addons:[]}).delete()},exists:function(t){return new De(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return function(t){var e=t.indexedDB,n=t.IDBKeyRange;return wn(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==Ct})}):_n(e,n).toCollection().primaryKeys()}(De.dependencies).then(t)}catch(e){return q(new M.MissingAPI)}},defineClass:function(){return function(e){Z(this,e)}},ignoreTransaction:function(t){return O.trans?Le(O.transless,t):t()},vip:En,async:function(t){return function(){try{var e=xn(t.apply(this,arguments));return e&&"function"==typeof e.then?e:k.resolve(e)}catch(n){return q(n)}}},spawn:function(t,e,n){try{var r=xn(t.apply(n,e||[]));return r&&"function"==typeof r.then?r:k.resolve(r)}catch(i){return q(i)}},currentTransaction:{get:function(){return O.trans||null}},waitFor:function(t,e){var n=k.resolve("function"==typeof t?De.ignoreTransaction(t):t).timeout(e||6e4);return O.trans?O.trans.waitFor(n):n},Promise:k,debug:{get:function(){return ue},set:function(t){Ln(t,"dexie"===t?function(){return!0}:ur)}},derive:Oe,extend:Z,props:Re,override:On,Events:et,on:xe,liveQuery:Kn,extendObservabilitySet:wr,getByKeyPath:fe,setByKeyPath:ae,delByKeyPath:function(t,e){"string"==typeof e?ae(t,e,void 0):"length"in e&&[].map.call(e,function(n){ae(t,n,void 0)})},shallowClone:Fn,deepClone:ze,getObjectDiff:Sn,cmp:J,asap:Bn,minKey:un,addons:[],connections:Je,errnames:Fr,dependencies:Dn,semVer:"3.2.0",version:"3.2.0".split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,2*n)})})),De.maxKey=it(De.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(xe(rt,function(t){var e;ye||(At?(e=document.createEvent("CustomEvent")).initCustomEvent(Ee,!0,!0,t):e=new CustomEvent(Ee,{detail:t}),ye=!0,dispatchEvent(e),ye=!1)}),addEventListener(Ee,function(t){ye||Ot(t.detail)}));var ye=!1;if("undefined"!=typeof BroadcastChannel){var Er=new BroadcastChannel(Ee);xe(rt,function(t){ye||Er.postMessage(t)}),Er.onmessage=function(t){t.data&&Ot(t.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){xe(rt,function(t){try{ye||("undefined"!=typeof localStorage&&localStorage.setItem(Ee,JSON.stringify({trig:Math.random(),changedParts:t})),"object"==typeof self.clients&&Ft([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:Ee,changedParts:t})}))}catch(e){}}),addEventListener("storage",function(t){if(t.key===Ee){var e=JSON.parse(t.newValue);e&&Ot(e.changedParts)}});var xr=self.document&&navigator.serviceWorker;xr&&xr.addEventListener("message",function(t){var e=t.data;e&&e.type===Ee&&Ot(e.changedParts)})}function ot(t,e){return t.mapToClass(e),t.upsert=function(){var n=(0,se.Z)(function*(r,i){let a=0;return(yield oa(t,r))?a=yield t.update(r,i):(yield t.add(i,r),a=1),!!a});return function(r,i){return n.apply(this,arguments)}}(),t}k.rejectionMapper=function(t,e){if(!t||t instanceof Fe||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Wn[t.name])return t;var n=new Wn[t.name](e||t.message,t);return"stack"in t&&le(n,"stack",{get:function(){return this.inner.stack}}),n},Ln(ue,ur);class ta{}class na{}class ra{}class ia{}class aa{}const ua=function(){var t=(0,se.Z)(function*(e,n){return(yield e.where("key").equals(n).count())>0});return function(n,r){return t.apply(this,arguments)}}(),oa=function(){var t=(0,se.Z)(function*(e,n){return!!(yield e.get(n))});return function(n,r){return t.apply(this,arguments)}}(),st=new class extends kn{constructor(){var e;super("BigmaManagerDB"),e=this,this.selectMaterialToggle=function(){var r=(0,se.Z)(function*(i,a){return e.transaction("rw",e.materials,(0,se.Z)(function*(){const u=yield e.materials.get(i);if(u){const{isSelected:o,sourceName:s}=u;if(!!o===a)return;const c=null!=a?a:!o||!0;yield e.materials.where("[sourceName+isSelected]").equals([s,1]).modify({isSelected:0}),yield e.materials.update(i,{isSelected:c?1:0})}}))});return function(i,a){return r.apply(this,arguments)}}(),this.version(5).stores({app:"&key, value",iframes:"&name,isActive,ownerApp,displayMode,detached,size,position,resizable,detachable,closeable",filters:"&name,isActive,ownerApp,displayName,icon",missions:"&id, name,id,data,members",sources:"&name, ownerApp,displayName,schema,isHiddenFromMap,isHiddenFromTimeline",materials:"&id, [sourceName+isSelected], sourceName, isSelected, ownerApp,type,interval,geo,string,drawStyle,additionalProps,visibilityOnMap"}),this._appTable=this.table("app");const n={get:(r=(0,se.Z)(function*(i,a){var u;return null===(u=yield e._appTable.get(a))||void 0===u?void 0:u.value}),function(a,u){return r.apply(this,arguments)}),set:function(){var r=(0,se.Z)(function*(i,a,u){let o=0;return(yield ua(e._appTable,a))?o=yield e._appTable.update(a,{value:u}):(yield e._appTable.add({key:a,value:u}),o=1),!!o||(console.error("can't update unexist property"),!1)});return function(a,u,o){return r.apply(this,arguments)}}(),delete:function(){var r=(0,se.Z)(function*(i){try{return yield e.table("app").delete(i),!0}catch(a){return console.error(a),!1}});return function(a){return r.apply(this,arguments)}}()};var r;this.app=new Proxy({},n),ot(this.iframes,ta),ot(this.filters,na),ot(this.missions,ra),ot(this.sources,aa),ot(this.materials,ia)}};console.log(st),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t,n,fa=(t=function(t,e){t.exports=function(){var n=Object.prototype.toString,r=Array.isArray||function(h){return"[object Array]"===n.call(h)};function i(b){return"function"==typeof b}function u(b){return b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(b,h){return null!=b&&"object"==typeof b&&h in b}function s(b,h){return null!=b&&"object"!=typeof b&&b.hasOwnProperty&&b.hasOwnProperty(h)}var c=RegExp.prototype.test;var l=/\S/;function p(b){return!function(b,h){return c.call(b,h)}(l,b)}var E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var d=/\s*/,g=/\s+/,x=/\s*=/,A=/\s*\}/,_=/#|\^|\/|>|\{|&|=|!/;function P(b){this.string=b,this.tail=b,this.pos=0}function T(b,h){this.view=b,this.cache={".":this.view},this.parent=h}function K(){this.templateCache={_cache:{},set:function(h,S){this._cache[h]=S},get:function(h){return this._cache[h]},clear:function(){this._cache={}}}}P.prototype.eos=function(){return""===this.tail},P.prototype.scan=function(h){var S=this.tail.match(h);if(!S||0!==S.index)return"";var m=S[0];return this.tail=this.tail.substring(m.length),this.pos+=m.length,m},P.prototype.scanUntil=function(h){var m,S=this.tail.search(h);switch(S){case-1:m=this.tail,this.tail="";break;case 0:m="";break;default:m=this.tail.substring(0,S),this.tail=this.tail.substring(S)}return this.pos+=m.length,m},T.prototype.push=function(h){return new T(h,this)},T.prototype.lookup=function(h){var m,S=this.cache;if(S.hasOwnProperty(h))m=S[h];else{for(var I,B,j,D=this,F=!1;D;){if(h.indexOf(".")>0)for(I=D.view,B=h.split("."),j=0;null!=I&&j<B.length;)j===B.length-1&&(F=o(I,B[j])||s(I,B[j])),I=I[B[j++]];else I=D.view[h],F=o(D.view,h);if(F){m=I;break}D=D.parent}S[h]=m}return i(m)&&(m=m.call(this.view)),m},K.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},K.prototype.parse=function(h,S){var m=this.templateCache,D=h+":"+(S||R.tags).join(":"),I=void 0!==m,B=I?m.get(D):void 0;return null==B&&(B=function(b,h){if(!b)return[];var ee,G,Ie,S=!1,m=[],D=[],I=[],B=!1,j=!1,F="",H=0;function W(){if(B&&!j)for(;I.length;)delete D[I.pop()];else I=[];B=!1,j=!1}function Bt(me){if("string"==typeof me&&(me=me.split(g,2)),!r(me)||2!==me.length)throw new Error("Invalid tags: "+me);ee=new RegExp(u(me[0])+"\\s*"),G=new RegExp("\\s*"+u(me[1])),Ie=new RegExp("\\s*"+u("}"+me[1]))}Bt(h||R.tags);for(var Se,te,ie,ct,Mt,Pe,Q=new P(b);!Q.eos();){if(Se=Q.pos,ie=Q.scanUntil(ee))for(var In=0,va=ie.length;In<va;++In)p(ct=ie.charAt(In))?(I.push(D.length),F+=ct):(j=!0,S=!0,F+=" "),D.push(["text",ct,Se,Se+1]),Se+=1,"\n"===ct&&(W(),F="",H=0,S=!1);if(!Q.scan(ee))break;if(B=!0,te=Q.scan(_)||"name",Q.scan(d),"="===te?(ie=Q.scanUntil(x),Q.scan(x),Q.scanUntil(G)):"{"===te?(ie=Q.scanUntil(Ie),Q.scan(A),Q.scanUntil(G),te="&"):ie=Q.scanUntil(G),!Q.scan(G))throw new Error("Unclosed tag at "+Q.pos);if(Mt=">"==te?[te,ie,Se,Q.pos,F,H,S]:[te,ie,Se,Q.pos],H++,D.push(Mt),"#"===te||"^"===te)m.push(Mt);else if("/"===te){if(!(Pe=m.pop()))throw new Error('Unopened section "'+ie+'" at '+Se);if(Pe[1]!==ie)throw new Error('Unclosed section "'+Pe[1]+'" at '+Se)}else"name"===te||"{"===te||"&"===te?j=!0:"="===te&&Bt(ie)}if(W(),Pe=m.pop())throw new Error('Unclosed section "'+Pe[1]+'" at '+Q.pos);return function(b){for(var D,h=[],S=h,m=[],B=0,j=b.length;B<j;++B)switch(D=b[B],D[0]){case"#":case"^":S.push(D),m.push(D),S=D[4]=[];break;case"/":m.pop()[5]=D[2],S=m.length>0?m[m.length-1][4]:h;break;default:S.push(D)}return h}(function(b){for(var S,m,h=[],D=0,I=b.length;D<I;++D)(S=b[D])&&("text"===S[0]&&m&&"text"===m[0]?(m[1]+=S[1],m[3]=S[3]):(h.push(S),m=S));return h}(D))}(h,S),I&&m.set(D,B)),B},K.prototype.render=function(h,S,m,D){var I=this.getConfigTags(D),B=this.parse(h,I),j=S instanceof T?S:new T(S,void 0);return this.renderTokens(B,j,m,h,D)},K.prototype.renderTokens=function(h,S,m,D,I){for(var j,F,H,B="",W=0,ee=h.length;W<ee;++W)H=void 0,"#"===(F=(j=h[W])[0])?H=this.renderSection(j,S,m,D,I):"^"===F?H=this.renderInverted(j,S,m,D,I):">"===F?H=this.renderPartial(j,S,m,I):"&"===F?H=this.unescapedValue(j,S):"name"===F?H=this.escapedValue(j,S,I):"text"===F&&(H=this.rawValue(j)),void 0!==H&&(B+=H);return B},K.prototype.renderSection=function(h,S,m,D,I){var B=this,j="",F=S.lookup(h[1]);if(F){if(r(F))for(var W=0,ee=F.length;W<ee;++W)j+=this.renderTokens(h[4],S.push(F[W]),m,D,I);else if("object"==typeof F||"string"==typeof F||"number"==typeof F)j+=this.renderTokens(h[4],S.push(F),m,D,I);else if(i(F)){if("string"!=typeof D)throw new Error("Cannot use higher-order sections without the original template");null!=(F=F.call(S.view,D.slice(h[3],h[5]),function(G){return B.render(G,S,m,I)}))&&(j+=F)}else j+=this.renderTokens(h[4],S,m,D,I);return j}},K.prototype.renderInverted=function(h,S,m,D,I){var B=S.lookup(h[1]);if(!B||r(B)&&0===B.length)return this.renderTokens(h[4],S,m,D,I)},K.prototype.indentPartial=function(h,S,m){for(var D=S.replace(/[^ \t]/g,""),I=h.split("\n"),B=0;B<I.length;B++)I[B].length&&(B>0||!m)&&(I[B]=D+I[B]);return I.join("\n")},K.prototype.renderPartial=function(h,S,m,D){if(m){var I=this.getConfigTags(D),B=i(m)?m(h[1]):m[h[1]];if(null!=B){var H=h[4],W=B;0==h[5]&&H&&(W=this.indentPartial(B,H,h[6]));var ee=this.parse(W,I);return this.renderTokens(ee,S,m,W,D)}}},K.prototype.unescapedValue=function(h,S){var m=S.lookup(h[1]);if(null!=m)return m},K.prototype.escapedValue=function(h,S,m){var D=this.getConfigEscape(m)||R.escape,I=S.lookup(h[1]);if(null!=I)return"number"==typeof I&&D===R.escape?String(I):D(I)},K.prototype.rawValue=function(h){return h[1]},K.prototype.getConfigTags=function(h){return r(h)?h:h&&"object"==typeof h?h.tags:void 0},K.prototype.getConfigEscape=function(h){if(h&&"object"==typeof h&&!r(h))return h.escape};var R={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(b){L.templateCache=b},get templateCache(){return L.templateCache}},L=new K;return R.clearCache=function(){return L.clearCache()},R.parse=function(h,S){return L.parse(h,S)},R.render=function(h,S,m,D){if("string"!=typeof h)throw new TypeError('Invalid template! Template should be a "string" but "'+((r(b=h)?"array":typeof b)+'" was given as the first argument for mustache#render(template, view, partials)'));var b;return L.render(h,S,m,D)},R.escape=function(b){return String(b).replace(/[&<>"'`=\/]/g,function(S){return E[S]})},R.Scanner=P,R.Context=T,R.Writer=K,R}()},t(n={path:undefined,exports:{},require:function(r,i){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}}),n.exports);const pa=st;console.log("UiList file Loaded");let Sr=class{constructor(t){var e=this;if((0,ce.r)(this,t),this.materials=[],this.subscribers=[],this.itemTemplate="{{id}}",this.selectHandler=r=>{pa.selectMaterialToggle(r.id)},this.onDelete=r=>{st.materials.delete(r)},console.log("UiList component Loaded"),!this.sourceName)return;const n=this.elm.querySelector('[slot="item-template"]');n&&(this.itemTemplate=this._getTemplateHtmlAsString(n)),this.subscribers.push(Kn(()=>st.materials.where("sourceName").equals(this.sourceName).toArray()).subscribe(r=>{this.materials=r})),this.subscribers.push(Kn((0,se.Z)(function*(){var r;return null===(r=yield st.materials.where("[sourceName+isSelected]").equals([e.sourceName,1]).first())||void 0===r?void 0:r.id})).subscribe(r=>{this.selected=r}))}scrollToSelected(t){var e;if(!t)return;const n=this.elm.querySelector("#"+this._buildId(t));console.log(n,"**el**"),null===(e=null==n?void 0:n.scrollIntoView)||void 0===e||e.call(n,{behavior:"smooth",block:"center"})}disconnectedCallback(){var t;null===(t=this.subscribers)||void 0===t||t.forEach(e=>{var n;return null===(n=null==e?void 0:e.unsubscribe)||void 0===n?void 0:n.call(e)})}_getTemplateHtmlAsString(t){return Array.from(t.children).map(n=>n.outerHTML).join("")}_buildId(t){return`item-${t}`}render(){var t;const e=null===(t=this.materials)||void 0===t?void 0:t.map(n=>{const r=fa.render(this.itemTemplate,n);return(0,ce.h)("div",{id:this._buildId(n.id),onClick:()=>this.selectHandler(n),class:"item-child material-item "+(n.isSelected?"selected":"")},(0,ce.h)("div",{class:"custom-content",innerHTML:r}),(0,ce.h)("div",{class:"actions"},(0,ce.h)("div",{class:"btns"},(0,ce.h)("button",{class:"details"},"Details"),(0,ce.h)("button",{onClick:()=>{this.onDelete(n.id)},class:"delete"},"Delete"))))});return(0,ce.h)("div",{class:"list-con"},e)}get elm(){return(0,ce.g)(this)}static get watchers(){return{selected:["scrollToSelected"]}}};Sr.style=":host{display:block}.material-item{display:flex;justify-content:space-between;padding:0.5em;border-bottom:1px solid gray}.material-item.selected{background-color:rgba(0, 255, 255, 0.561)}.material-item.selected button.delete{background-color:#c02d2d}.material-item.selected button.details{background-color:#57c02d}.material-item .btns{display:flex;gap:0.3em}.material-item button{background-color:transparent;border:1px solid transparent;color:#eee;cursor:pointer;border-radius:2px;transition:all 0.3s ease}.material-item button:hover{background-color:#c02d2d}.material-item button.details:hover{background-color:rgba(86, 200, 40, 0.774)}"}}]);